###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         04/Jul/2018  22:34:44 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\Source\SmartHomeApp.c                    #
#    Command line       =  -f C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\ #
#                          SmartHomeApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wC #
#                          oord.cfg (-DCPU32MHZ -DROOT=__near_func            #
#                          -DMAC_CFG_APP_PENDING_QUEUE=TRUE                   #
#                          -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8         #
#                          -DMAC_CFG_RX_MAX=5 -DZDO_COORDINATOR -DRTR_NWK)    #
#                          -f C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\ #
#                          SmartHomeApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wC #
#                          onfig.cfg (-DZIGBEEPRO -DSECURE=0                  #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00002000                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xF227                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 C:\ZigBee\SmartHomeApp\Proj #
#                          ects\zstack\Samples\SmartHomeApp\Source\SmartHomeA #
#                          pp.c -D ZTOOL_P1 -D MT_TASK -D MT_SYS_FUNC -D      #
#                          MT_ZDO_FUNC -D xLCD_SUPPORTED=DEBUG -lC            #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\CoordinatorEB\List\ -lA         #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\CoordinatorEB\List\             #
#                          --diag_suppress Pe001,Pa010 -o                     #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\CoordinatorEB\Obj\ -e           #
#                          --no_code_motion --debug --core=plain --dptr=16,1  #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\ #
#                          SmartHomeApp\CC2530DB\ -I                          #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\Source\ -I                   #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\ZMain\TI2530DB\ -I     #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\hal\i #
#                          nclude\ -I C:\ZigBee\SmartHomeApp\Projects\zstack\ #
#                          Samples\SmartHomeApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\hal\target\CC2530EB\ -I                      #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\mac\i #
#                          nclude\ -I C:\ZigBee\SmartHomeApp\Projects\zstack\ #
#                          Samples\SmartHomeApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\high_level\ -I                           #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\mac\l #
#                          ow_level\srf04\ -I C:\ZigBee\SmartHomeApp\Projects #
#                          \zstack\Samples\SmartHomeApp\CC2530DB\..\..\..\..\ #
#                          ..\Components\mac\low_level\srf04\single_chip\ -I  #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\mt\   #
#                          -I C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\ #
#                          SmartHomeApp\CC2530DB\..\..\..\..\..\Components\os #
#                          al\include\ -I C:\ZigBee\SmartHomeApp\Projects\zst #
#                          ack\Samples\SmartHomeApp\CC2530DB\..\..\..\..\..\C #
#                          omponents\services\saddr\ -I                       #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\servi #
#                          ces\sdata\ -I C:\ZigBee\SmartHomeApp\Projects\zsta #
#                          ck\Samples\SmartHomeApp\CC2530DB\..\..\..\..\..\Co #
#                          mponents\stack\af\ -I C:\ZigBee\SmartHomeApp\Proje #
#                          cts\zstack\Samples\SmartHomeApp\CC2530DB\..\..\..\ #
#                          ..\..\Components\stack\nwk\ -I                     #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\stack #
#                          \sapi\ -I C:\ZigBee\SmartHomeApp\Projects\zstack\S #
#                          amples\SmartHomeApp\CC2530DB\..\..\..\..\..\Compon #
#                          ents\stack\sec\ -I C:\ZigBee\SmartHomeApp\Projects #
#                          \zstack\Samples\SmartHomeApp\CC2530DB\..\..\..\..\ #
#                          ..\Components\stack\sys\ -I                        #
#                          C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\..\..\..\..\..\Components\stack #
#                          \zdo\ -I C:\ZigBee\SmartHomeApp\Projects\zstack\Sa #
#                          mples\SmartHomeApp\CC2530DB\..\..\..\..\..\Compone #
#                          nts\zmac\ -I C:\ZigBee\SmartHomeApp\Projects\zstac #
#                          k\Samples\SmartHomeApp\CC2530DB\..\..\..\..\..\Com #
#                          ponents\zmac\f8w\ -Ohz --require_prototypes        #
#    List file          =  C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\CoordinatorEB\List\SmartHomeApp #
#                          .lst                                               #
#    Object file        =  C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\Sma #
#                          rtHomeApp\CC2530DB\CoordinatorEB\Obj\SmartHomeApp. #
#                          r51                                                #
#                                                                             #
#                                                                             #
###############################################################################

C:\ZigBee\SmartHomeApp\Projects\zstack\Samples\SmartHomeApp\Source\SmartHomeApp.c
      1          /******************************************************************************
      2            Filename:       SmartHomeApp.c
      3            Revised:        $Date: 2012-03-07 01:04:58 -0800 (Wed, 07 Mar 2012) $
      4            Revision:       $Revision: 29656 $
      5          
      6            Description:    Generic Application (no Profile).
      7          
      8          
      9            Copyright 2004-2012 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License"). You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product. Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          ******************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends "Hello World" to another "Generic"
     45            application every 5 seconds.  The application will also
     46            receives "Hello World" packets.
     47          
     48            The "Hello World" messages are sent/received as MSG type message.
     49          
     50            This applications doesn't have a profile, so it handles everything
     51            directly - itself.
     52          
     53            Key control:
     54              SW1:
     55              SW2:  initiates end device binding
     56              SW3:
     57              SW4:  initiates a match description request
     58          *********************************************************************/
     59          
     60          /*********************************************************************
     61           * INCLUDES
     62           */
     63          #include "OSAL.h"
     64          #include "AF.h"
     65          #include "ZDApp.h"
     66          #include "ZDObject.h"
     67          #include "ZDProfile.h"
     68          
     69          #include "SmartHomeApp.h"
     70          #include "DebugTrace.h"
     71          
     72          #if !defined( WIN32 )
     73            #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc9
   \   unsigned char volatile __sfr WDCTL
   \                     WDCTL:
   \   000000                DS 1
     74          #endif
     75          
     76          /* HAL */
     77          #include "hal_lcd.h"
     78          #include "hal_led.h"
     79          #include "hal_key.h"
     80          #include "hal_uart.h"
     81          
     82          #include "user_printf.h"
     83          #include "Utils.h"
     84          
     85          #include "DefaultProcessor.h"
     86          #include "DoorLight.h"
     87          #include "DoorSensor.h"
     88          
     89          
     90          /*********************************************************************
     91           * MACROS
     92           */
     93          
     94          /*********************************************************************
     95           * CONSTANTS
     96           */
     97          
     98          /*********************************************************************
     99           * TYPEDEFS
    100           */
    101          
    102          /*********************************************************************
    103           * GLOBAL VARIABLES
    104           */
    105          // This list should be filled with Application specific Cluster IDs.

   \                                 In  segment XDATA_ROM_C, align 1
    106          const cId_t SmartHomeApp_ClusterList[SmartHomeApp_MAX_CLUSTERS] =
   \                     SmartHomeApp_ClusterList:
   \   000000   0100         DW 1
    107          {
    108            SmartHomeApp_CLUSTERID
    109          };
    110          

   \                                 In  segment XDATA_ROM_C, align 1
    111          const SimpleDescriptionFormat_t SmartHomeApp_SimpleDesc =
   \                     SmartHomeApp_SimpleDesc:
   \   000000   0A           DB 10
   \   000001   040F         DW 3844
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   01           DB 1
   \   000007   ....         DW SmartHomeApp_ClusterList
   \   000009   01           DB 1
   \   00000A   ....         DW SmartHomeApp_ClusterList
    112          {
    113            SmartHomeApp_ENDPOINT,              //  int Endpoint;
    114            SmartHomeApp_PROFID,                //  uint16 AppProfId[2];
    115            SmartHomeApp_DEVICEID,              //  uint16 AppDeviceId[2];
    116            SmartHomeApp_DEVICE_VERSION,        //  int   AppDevVer:4;
    117            SmartHomeApp_FLAGS,                 //  int   AppFlags:4;
    118            SmartHomeApp_MAX_CLUSTERS,          //  byte  AppNumInClusters;
    119            (cId_t *)SmartHomeApp_ClusterList,  //  byte *pAppInClusterList;
    120            SmartHomeApp_MAX_CLUSTERS,          //  byte  AppNumInClusters;
    121            (cId_t *)SmartHomeApp_ClusterList   //  byte *pAppInClusterList;
    122          };
    123          
    124          // This is the Endpoint/Interface description.  It is defined here, but
    125          // filled-in in SmartHomeApp_Init().  Another way to go would be to fill
    126          // in the structure here and make it a "const" (in code space).  The
    127          // way it's defined in this sample app it is define in RAM.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    128          endPointDesc_t SmartHomeApp_epDesc;
   \                     SmartHomeApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
    129          
    130          #define SERIAL_APP_TX_MAX 64

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    131          uint8 RxBuf[SERIAL_APP_TX_MAX+1];
   \                     RxBuf:
   \   000000                DS 65
   \   000041                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    132          static uint8 SerialApp_TxLen;
   \                     SerialApp_TxLen:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    133          static uint16 SmartHomeApp_LastSendAddr;
   \                     SmartHomeApp_LastSendAddr:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    134          static uint16 SmartHomeApp_LastSendTransID;
   \                     SmartHomeApp_LastSendTransID:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    135          
    136          /*********************************************************************
    137           * EXTERNAL VARIABLES
    138           */
    139          
    140          /*********************************************************************
    141           * EXTERNAL FUNCTIONS
    142           */
    143          
    144          /*********************************************************************
    145           * LOCAL VARIABLES
    146           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    147          byte SmartHomeApp_TaskID;   // Task ID for internal task/event processing
   \                     SmartHomeApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    148                                    // This variable will be received when
    149                                    // SmartHomeApp_Init() is called.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    150          devStates_t SmartHomeApp_NwkState;
   \                     SmartHomeApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    151          
    152          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    153          byte SmartHomeApp_TransID;  // This is the unique message ID (counter)
   \                     SmartHomeApp_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    154          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    155          afAddrType_t SmartHomeApp_DstAddr;
   \                     SmartHomeApp_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    156          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    157          void (*Processor_HandleKeys)(uint8 keys);
   \                     Processor_HandleKeys:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    158          void (*Processor_HandleMsg)(uint8* msg);
   \                     Processor_HandleMsg:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    159          void (*Processor_Init)(void);
   \                     Processor_Init:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    160          void (*Processor_Update)(void);
   \                     Processor_Update:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    161          
    162          /*********************************************************************
    163           * LOCAL FUNCTIONS
    164           */
    165          static void SmartHomeApp_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
    166          static void SmartHomeApp_HandleKeys( byte shift, byte keys );
    167          static void SmartHomeApp_MessageMSGCB( afIncomingMSGPacket_t *pckt );
    168          //static void SmartHomeApp_SendTheMessage( void );
    169          
    170          
    171          
    172          /*********************************************************************
    173           * NETWORK LAYER CALLBACKS
    174           */
    175          
    176          /*********************************************************************
    177           * PUBLIC FUNCTIONS
    178           */
    179          
    180          /*********************************************************************
    181           * @fn      SmartHomeApp_Init
    182           *
    183           * @brief   Initialization function for the Generic App Task.
    184           *          This is called during initialization and should contain
    185           *          any application specific initialization (ie. hardware
    186           *          initialization/setup, table initialization, power up
    187           *          notificaiton ... ).
    188           *
    189           * @param   task_id - the ID assigned by OSAL.  This ID should be
    190           *                    used to send messages and set timers.
    191           *
    192           * @return  none
    193           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    194          void SmartHomeApp_Init( uint8 task_id )
   \                     SmartHomeApp_Init:
    195          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 29
   \   000005   74E3         MOV     A,#-0x1d
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
    196            SmartHomeApp_TaskID = task_id;
   \   00000B   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   00000E   F0           MOVX    @DPTR,A
    197            SmartHomeApp_NwkState = DEV_INIT;
   \   00000F   90....       MOV     DPTR,#SmartHomeApp_NwkState
   \   000012   7401         MOV     A,#0x1
   \   000014   F0           MOVX    @DPTR,A
    198            SmartHomeApp_TransID = 0;
   \   000015   90....       MOV     DPTR,#SmartHomeApp_TransID
   \   000018   E4           CLR     A
   \   000019   F0           MOVX    @DPTR,A
    199          
    200            // Device hardware initialization can be added here or in main() (Zmain.c).
    201            // If the hardware is application specific - add it here.
    202            // If the hardware is other parts of the device add it in main().
    203            
    204            halUARTCfg_t uartConfig;
    205            uartConfig.configured           = TRUE;
   \   00001A   85..82       MOV     DPL,?XSP + 0
   \   00001D   85..83       MOV     DPH,?XSP + 1
   \   000020   04           INC     A
   \   000021   F0           MOVX    @DPTR,A
    206            uartConfig.baudRate             = HAL_UART_BR_115200;
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   7404         MOV     A,#0x4
   \   000027   F0           MOVX    @DPTR,A
    207            uartConfig.flowControl          = FALSE;
   \   000028   7402         MOV     A,#0x2
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   E4           CLR     A
   \   00002E   F0           MOVX    @DPTR,A
    208            uartConfig.flowControlThreshold = 48;
   \   00002F   7403         MOV     A,#0x3
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   7430         MOV     A,#0x30
   \   000036   F0           MOVX    @DPTR,A
   \   000037   A3           INC     DPTR
   \   000038   E4           CLR     A
   \   000039   F0           MOVX    @DPTR,A
    209            uartConfig.rx.maxBufSize        = 128;
   \   00003A   740A         MOV     A,#0xa
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   7480         MOV     A,#-0x80
   \   000041   F0           MOVX    @DPTR,A
   \   000042   A3           INC     DPTR
   \   000043   E4           CLR     A
   \   000044   F0           MOVX    @DPTR,A
    210            uartConfig.tx.maxBufSize        = 128;
   \   000045   7412         MOV     A,#0x12
   \   000047   12....       LCALL   ?XSTACK_DISP0_8
   \   00004A   7480         MOV     A,#-0x80
   \   00004C   F0           MOVX    @DPTR,A
   \   00004D   A3           INC     DPTR
   \   00004E   E4           CLR     A
   \   00004F   F0           MOVX    @DPTR,A
    211            uartConfig.idleTimeout          = 6;   
   \   000050   7405         MOV     A,#0x5
   \   000052   12....       LCALL   ?XSTACK_DISP0_8
   \   000055   7406         MOV     A,#0x6
   \   000057   F0           MOVX    @DPTR,A
    212            uartConfig.intEnable            = TRUE;              
   \   000058   7416         MOV     A,#0x16
   \   00005A   12....       LCALL   ?XSTACK_DISP0_8
   \   00005D   7401         MOV     A,#0x1
   \   00005F   F0           MOVX    @DPTR,A
    213            uartConfig.callBackFunc         = SmartHomeApp_CallBack;
   \   000060   741B         MOV     A,#0x1b
   \   000062   12....       LCALL   ?XSTACK_DISP0_8
   \   000065   74..         MOV     A,#??SmartHomeApp_CallBack?relay & 0xff
   \   000067   F0           MOVX    @DPTR,A
   \   000068   A3           INC     DPTR
   \   000069   74..         MOV     A,#(??SmartHomeApp_CallBack?relay >> 8) & 0xff
   \   00006B   F0           MOVX    @DPTR,A
    214            HalUARTOpen (HAL_UART_PORT_0, &uartConfig);
   \   00006C                ; Setup parameters for call to function HalUARTOpen
   \   00006C   85..82       MOV     DPL,?XSP + 0
   \   00006F   85..83       MOV     DPH,?XSP + 1
   \   000072   AA82         MOV     R2,DPL
   \   000074   AB83         MOV     R3,DPH
   \   000076   7900         MOV     R1,#0x0
   \   000078   12....       LCALL   ??HalUARTOpen?relay
    215            
    216           // uint8 msg[] = "hello,world!";
    217          //  HalUARTWrite(HAL_UART_PORT_0, msg, sizeof(msg));
    218            
    219            printf("My name is %s\n", Util_ReadName());
   \   00007B                ; Setup parameters for call to function printf
   \   00007B                ; Setup parameters for call to function Util_ReadName
   \   00007B   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   00007E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000081   7A..         MOV     R2,#`?<Constant "My name is %s\\n">` & 0xff
   \   000083   7B..         MOV     R3,#(`?<Constant "My name is %s\\n">` >> 8) & 0xff
   \   000085   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000088   12....       LCALL   ?DEALLOC_XSTACK8
    220            
    221            if (Util_StrEqual((uint8*)"DoorLight", Util_ReadName())) {    
   \   00008B                ; Setup parameters for call to function Util_StrEqual
   \   00008B                ; Setup parameters for call to function Util_ReadName
   \   00008B   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   00008E   7A..         MOV     R2,#`?<Constant "DoorLight">` & 0xff
   \   000090   7B..         MOV     R3,#(`?<Constant "DoorLight">` >> 8) & 0xff
   \   000092   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_40:
   \   000095   6029         JZ      ??SmartHomeApp_Init_0
    222              Processor_HandleKeys = &DoorLight_HandleKeys;
   \   000097   90....       MOV     DPTR,#Processor_HandleKeys
   \   00009A   74..         MOV     A,#??DoorLight_HandleKeys?relay & 0xff
   \   00009C   F0           MOVX    @DPTR,A
   \   00009D   A3           INC     DPTR
   \   00009E   74..         MOV     A,#(??DoorLight_HandleKeys?relay >> 8) & 0xff
   \   0000A0   F0           MOVX    @DPTR,A
    223              Processor_HandleMsg = &DoorLight_HandleMsg;
   \   0000A1   90....       MOV     DPTR,#Processor_HandleMsg
   \   0000A4   74..         MOV     A,#??DoorLight_HandleMsg?relay & 0xff
   \   0000A6   F0           MOVX    @DPTR,A
   \   0000A7   A3           INC     DPTR
   \   0000A8   74..         MOV     A,#(??DoorLight_HandleMsg?relay >> 8) & 0xff
   \   0000AA   F0           MOVX    @DPTR,A
    224              Processor_Init = &DoorLight_Init;
   \   0000AB   90....       MOV     DPTR,#Processor_Init
   \   0000AE   74..         MOV     A,#??DoorLight_Init?relay & 0xff
   \   0000B0   F0           MOVX    @DPTR,A
   \   0000B1   A3           INC     DPTR
   \   0000B2   74..         MOV     A,#(??DoorLight_Init?relay >> 8) & 0xff
   \   0000B4   F0           MOVX    @DPTR,A
    225              Processor_Update = &DoorLight_Update;
   \   0000B5   90....       MOV     DPTR,#Processor_Update
   \   0000B8   74..         MOV     A,#??DoorLight_Update?relay & 0xff
   \   0000BA   F0           MOVX    @DPTR,A
   \   0000BB   A3           INC     DPTR
   \   0000BC   74..         MOV     A,#(??DoorLight_Update?relay >> 8) & 0xff
   \   0000BE   806C         SJMP    ??SmartHomeApp_Init_1
    226              
    227            } else if (Util_StrEqual((uint8*)"DoorSensor", Util_ReadName())) {    
   \                     ??SmartHomeApp_Init_0:
   \   0000C0                ; Setup parameters for call to function Util_StrEqual
   \   0000C0                ; Setup parameters for call to function Util_ReadName
   \   0000C0   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   0000C3   7A..         MOV     R2,#`?<Constant "DoorSensor">` & 0xff
   \   0000C5   7B..         MOV     R3,#(`?<Constant "DoorSensor">` >> 8) & 0xff
   \   0000C7   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_41:
   \   0000CA   6029         JZ      ??SmartHomeApp_Init_2
    228              Processor_HandleKeys = &DoorSensor_HandleKeys;
   \   0000CC   90....       MOV     DPTR,#Processor_HandleKeys
   \   0000CF   74..         MOV     A,#??DoorSensor_HandleKeys?relay & 0xff
   \   0000D1   F0           MOVX    @DPTR,A
   \   0000D2   A3           INC     DPTR
   \   0000D3   74..         MOV     A,#(??DoorSensor_HandleKeys?relay >> 8) & 0xff
   \   0000D5   F0           MOVX    @DPTR,A
    229              Processor_HandleMsg = &DoorSensor_HandleMsg;
   \   0000D6   90....       MOV     DPTR,#Processor_HandleMsg
   \   0000D9   74..         MOV     A,#??DoorSensor_HandleMsg?relay & 0xff
   \   0000DB   F0           MOVX    @DPTR,A
   \   0000DC   A3           INC     DPTR
   \   0000DD   74..         MOV     A,#(??DoorSensor_HandleMsg?relay >> 8) & 0xff
   \   0000DF   F0           MOVX    @DPTR,A
    230              Processor_Init = &DoorSensor_Init;
   \   0000E0   90....       MOV     DPTR,#Processor_Init
   \   0000E3   74..         MOV     A,#??DoorSensor_Init?relay & 0xff
   \   0000E5   F0           MOVX    @DPTR,A
   \   0000E6   A3           INC     DPTR
   \   0000E7   74..         MOV     A,#(??DoorSensor_Init?relay >> 8) & 0xff
   \   0000E9   F0           MOVX    @DPTR,A
    231              Processor_Update = &DoorSensor_Update;
   \   0000EA   90....       MOV     DPTR,#Processor_Update
   \   0000ED   74..         MOV     A,#??DoorSensor_Update?relay & 0xff
   \   0000EF   F0           MOVX    @DPTR,A
   \   0000F0   A3           INC     DPTR
   \   0000F1   74..         MOV     A,#(??DoorSensor_Update?relay >> 8) & 0xff
   \   0000F3   8037         SJMP    ??SmartHomeApp_Init_1
    232              
    233            } else {
    234              printf("ERROR: Unkown name: %s\n", Util_ReadName());
   \                     ??SmartHomeApp_Init_2:
   \   0000F5                ; Setup parameters for call to function printf
   \   0000F5                ; Setup parameters for call to function Util_ReadName
   \   0000F5   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   0000F8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000FB   7A..         MOV     R2,#`?<Constant "ERROR: Unkown name: %s\\n">` & 0xff
   \   0000FD   7B..         MOV     R3,#(`?<Constant "ERROR: Unkown name: %s\\n">` >> 8) & 0xff
   \   0000FF   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000102   12....       LCALL   ?DEALLOC_XSTACK8
    235              Processor_HandleKeys = &DefaultProcessor_HandleKeys;
   \   000105   90....       MOV     DPTR,#Processor_HandleKeys
   \   000108   74..         MOV     A,#??DefaultProcessor_HandleKeys?relay & 0xff
   \   00010A   F0           MOVX    @DPTR,A
   \   00010B   A3           INC     DPTR
   \   00010C   74..         MOV     A,#(??DefaultProcessor_HandleKeys?relay >> 8) & 0xff
   \   00010E   F0           MOVX    @DPTR,A
    236              Processor_HandleMsg = &DefaultProcessor_HandleMsg;
   \   00010F   90....       MOV     DPTR,#Processor_HandleMsg
   \   000112   74..         MOV     A,#??DefaultProcessor_HandleMsg?relay & 0xff
   \   000114   F0           MOVX    @DPTR,A
   \   000115   A3           INC     DPTR
   \   000116   74..         MOV     A,#(??DefaultProcessor_HandleMsg?relay >> 8) & 0xff
   \   000118   F0           MOVX    @DPTR,A
    237              Processor_Init = &DefaultProcessor_Init;
   \   000119   90....       MOV     DPTR,#Processor_Init
   \   00011C   74..         MOV     A,#??DefaultProcessor_Init?relay & 0xff
   \   00011E   F0           MOVX    @DPTR,A
   \   00011F   A3           INC     DPTR
   \   000120   74..         MOV     A,#(??DefaultProcessor_Init?relay >> 8) & 0xff
   \   000122   F0           MOVX    @DPTR,A
    238              Processor_Update = &DefaultProcessor_Update;
   \   000123   90....       MOV     DPTR,#Processor_Update
   \   000126   74..         MOV     A,#??DefaultProcessor_Update?relay & 0xff
   \   000128   F0           MOVX    @DPTR,A
   \   000129   A3           INC     DPTR
   \   00012A   74..         MOV     A,#(??DefaultProcessor_Update?relay >> 8) & 0xff
   \                     ??SmartHomeApp_Init_1:
   \   00012C   F0           MOVX    @DPTR,A
    239            }
    240            
    241            Processor_Init();
   \   00012D                ; Setup parameters for indirect call
   \   00012D   90....       MOV     DPTR,#Processor_Init
   \   000130   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   000133   12....       LCALL   ?CALL_IND
    242            
    243            SmartHomeApp_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
   \   000136   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 8
   \   000139   E4           CLR     A
   \   00013A   F0           MOVX    @DPTR,A
    244            SmartHomeApp_DstAddr.endPoint = SmartHomeApp_ENDPOINT;
   \   00013B   A3           INC     DPTR
   \   00013C   740A         MOV     A,#0xa
   \   00013E   F0           MOVX    @DPTR,A
    245            SmartHomeApp_DstAddr.addr.shortAddr = 0;
   \   00013F   90....       MOV     DPTR,#SmartHomeApp_DstAddr
   \   000142   E4           CLR     A
   \   000143   F0           MOVX    @DPTR,A
   \   000144   A3           INC     DPTR
   \   000145   F0           MOVX    @DPTR,A
    246          
    247            
    248            
    249            // Fill out the endpoint description.
    250            SmartHomeApp_epDesc.endPoint = SmartHomeApp_ENDPOINT;
   \   000146   90....       MOV     DPTR,#SmartHomeApp_epDesc
   \   000149   740A         MOV     A,#0xa
   \   00014B   F0           MOVX    @DPTR,A
    251            SmartHomeApp_epDesc.task_id = &SmartHomeApp_TaskID;
   \   00014C   A3           INC     DPTR
   \   00014D   74..         MOV     A,#SmartHomeApp_TaskID & 0xff
   \   00014F   F0           MOVX    @DPTR,A
   \   000150   A3           INC     DPTR
   \   000151   74..         MOV     A,#(SmartHomeApp_TaskID >> 8) & 0xff
   \   000153   F0           MOVX    @DPTR,A
    252            SmartHomeApp_epDesc.simpleDesc
    253                      = (SimpleDescriptionFormat_t *)&SmartHomeApp_SimpleDesc;
   \   000154   A3           INC     DPTR
   \   000155   74..         MOV     A,#SmartHomeApp_SimpleDesc & 0xff
   \   000157   F0           MOVX    @DPTR,A
   \   000158   A3           INC     DPTR
   \   000159   74..         MOV     A,#(SmartHomeApp_SimpleDesc >> 8) & 0xff
   \   00015B   F0           MOVX    @DPTR,A
    254            SmartHomeApp_epDesc.latencyReq = noLatencyReqs;
   \   00015C   A3           INC     DPTR
   \   00015D   E4           CLR     A
   \   00015E   F0           MOVX    @DPTR,A
    255          
    256            // Register the endpoint description with the AF
    257            afRegister( &SmartHomeApp_epDesc );
   \   00015F                ; Setup parameters for call to function afRegister
   \   00015F   7A..         MOV     R2,#SmartHomeApp_epDesc & 0xff
   \   000161   7B..         MOV     R3,#(SmartHomeApp_epDesc >> 8) & 0xff
   \   000163   12....       LCALL   ??afRegister?relay
    258          
    259            // Register for all key events - This app will handle all key events
    260            RegisterForKeys( SmartHomeApp_TaskID );
   \   000166                ; Setup parameters for call to function RegisterForKeys
   \   000166   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   000169   E0           MOVX    A,@DPTR
   \   00016A   F9           MOV     R1,A
   \   00016B   12....       LCALL   ??RegisterForKeys?relay
    261          
    262            // Update the display
    263          #if defined ( LCD_SUPPORTED )
    264            HalLcdWriteString( "SmartHomeApp", HAL_LCD_LINE_1 );
    265          #endif
    266          
    267            ZDO_RegisterForZDOMsg( SmartHomeApp_TaskID, End_Device_Bind_rsp );
   \   00016E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00016E   7A20         MOV     R2,#0x20
   \   000170   7B80         MOV     R3,#-0x80
   \   000172   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   000175   E0           MOVX    A,@DPTR
   \   000176   F9           MOV     R1,A
   \   000177   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    268            ZDO_RegisterForZDOMsg( SmartHomeApp_TaskID, Match_Desc_rsp );
   \   00017A                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00017A   7A06         MOV     R2,#0x6
   \   00017C   7B80         MOV     R3,#-0x80
   \   00017E   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   000181   E0           MOVX    A,@DPTR
   \   000182   F9           MOV     R1,A
   \   000183   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    269          
    270          }
   \   000186   741D         MOV     A,#0x1d
   \   000188   12....       LCALL   ?DEALLOC_XSTACK8
   \   00018B   7F02         MOV     R7,#0x2
   \   00018D   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine14_0:
   \   000000   12....       LCALL   ??Util_StrEqual?relay
   \   000003   E9           MOV     A,R1
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F583         MOV     DPH,A
   \   000006   8882         MOV     DPL,R0
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL   ??printf?relay
   \   000003   7402         MOV     A,#0x2
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   12....       LCALL   ??Util_ReadName?relay
   \   000003   8A..         MOV     ?V0 + 0,R2
   \   000005   8B..         MOV     ?V0 + 1,R3
   \   000007                ; Setup parameters for call to function sprintf
   \   000007   78..         MOV     R0,#?V0 + 0
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   12....       LCALL   ??Util_ReadName?relay
   \   000003   EA           MOV     A,R2
   \   000004   FC           MOV     R4,A
   \   000005   EB           MOV     A,R3
   \   000006   FD           MOV     R5,A
   \   000007   22           RET
    271          
    272          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    273          void SmartHome_SendCmd(uint8* buf)
   \                     SmartHome_SendCmd:
    274          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
    275            
    276            uint16 destAddr;
    277            
    278            destAddr =  NameAddrCache_getAddrFromCmd(buf);
   \   000009                ; Setup parameters for call to function NameAddrCache_getAddrFromCmd
   \   000009   12....       LCALL   ??NameAddrCache_getAddrFromCmd?relay
   \   00000C   8A..         MOV     ?V0 + 2,R2
   \   00000E   8B..         MOV     ?V0 + 3,R3
   \   000010   A8..         MOV     R0,?V0 + 2
   \   000012   A9..         MOV     R1,?V0 + 3
    279            
    280            if (destAddr == 0xFFFF) {
   \   000014   74FF         MOV     A,#-0x1
   \   000016   68           XRL     A,R0
   \   000017   7003         JNZ     ??SmartHome_SendCmd_0
   \   000019   74FF         MOV     A,#-0x1
   \   00001B   69           XRL     A,R1
   \                     ??SmartHome_SendCmd_0:
   \   00001C   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 8
   \   00001F   7004         JNZ     ??SmartHome_SendCmd_1
    281              SmartHomeApp_DstAddr.addrMode = afAddrBroadcast;
   \   000021   740F         MOV     A,#0xf
   \   000023   8015         SJMP    ??SmartHome_SendCmd_2
    282            } else {
    283              SmartHomeApp_DstAddr.addrMode = afAddr16Bit;
   \                     ??SmartHome_SendCmd_1:
   \   000025   7402         MOV     A,#0x2
   \   000027   F0           MOVX    @DPTR,A
    284              SmartHomeApp_LastSendAddr = destAddr;
   \   000028   90....       MOV     DPTR,#SmartHomeApp_LastSendAddr
   \   00002B   E8           MOV     A,R0
   \   00002C   F0           MOVX    @DPTR,A
   \   00002D   A3           INC     DPTR
   \   00002E   E9           MOV     A,R1
   \   00002F   F0           MOVX    @DPTR,A
    285              SmartHomeApp_LastSendTransID = SmartHomeApp_TransID;
   \   000030   90....       MOV     DPTR,#SmartHomeApp_TransID
   \   000033   E0           MOVX    A,@DPTR
   \   000034   90....       MOV     DPTR,#SmartHomeApp_LastSendTransID
   \   000037   F0           MOVX    @DPTR,A
   \   000038   A3           INC     DPTR
   \   000039   E4           CLR     A
   \                     ??SmartHome_SendCmd_2:
   \   00003A   F0           MOVX    @DPTR,A
    286            }
    287           
    288            SmartHomeApp_DstAddr.addr.shortAddr=destAddr;
   \   00003B   90....       MOV     DPTR,#SmartHomeApp_DstAddr
   \   00003E   E8           MOV     A,R0
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   E9           MOV     A,R1
   \   000042   F0           MOVX    @DPTR,A
    289           
    290              
    291            SmartHomeApp_DstAddr.endPoint = SmartHomeApp_ENDPOINT;
   \   000043   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 9
   \   000046   740A         MOV     A,#0xa
   \   000048   F0           MOVX    @DPTR,A
    292            
    293            if ( AF_DataRequest( &SmartHomeApp_DstAddr, &SmartHomeApp_epDesc,
    294                                 SmartHomeApp_CLUSTERID,
    295                                 (byte)osal_strlen( (char*)buf ) + 1,
    296                                 (byte *)buf,
    297                                 &SmartHomeApp_TransID,
    298                                 AF_DISCV_ROUTE, AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   000049                ; Setup parameters for call to function AF_DataRequest
   \   000049   75..1E       MOV     ?V0 + 2,#0x1e
   \   00004C   78..         MOV     R0,#?V0 + 2
   \   00004E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000051   75....       MOV     ?V0 + 2,#SmartHomeApp_TransID & 0xff
   \   000054   75....       MOV     ?V0 + 3,#(SmartHomeApp_TransID >> 8) & 0xff
   \   000057   78..         MOV     R0,#?V0 + 2
   \   000059   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005C   78..         MOV     R0,#?V0 + 0
   \   00005E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000061                ; Setup parameters for call to function osal_strlen
   \   000061   AA..         MOV     R2,?V0 + 0
   \   000063   AB..         MOV     R3,?V0 + 1
   \   000065   12....       LCALL   ??osal_strlen?relay
   \   000068   EA           MOV     A,R2
   \   000069   2401         ADD     A,#0x1
   \   00006B   F5..         MOV     ?V0 + 2,A
   \   00006D   E4           CLR     A
   \   00006E   3400         ADDC    A,#0x0
   \   000070   F5..         MOV     ?V0 + 3,A
   \   000072   78..         MOV     R0,#?V0 + 2
   \   000074   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000077   75..01       MOV     ?V0 + 2,#0x1
   \   00007A   75..00       MOV     ?V0 + 3,#0x0
   \   00007D   78..         MOV     R0,#?V0 + 2
   \   00007F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000082   7920         MOV     R1,#0x20
   \   000084   7C..         MOV     R4,#SmartHomeApp_epDesc & 0xff
   \   000086   7D..         MOV     R5,#(SmartHomeApp_epDesc >> 8) & 0xff
   \   000088   7A..         MOV     R2,#SmartHomeApp_DstAddr & 0xff
   \   00008A   7B..         MOV     R3,#(SmartHomeApp_DstAddr >> 8) & 0xff
   \   00008C   12....       LCALL   ??AF_DataRequest?relay
   \   00008F   7409         MOV     A,#0x9
   \   000091   12....       LCALL   ?DEALLOC_XSTACK8
   \   000094   E9           MOV     A,R1
   \   000095   600F         JZ      ??SmartHome_SendCmd_3
    299            {
    300            //  printf("SendCmdOK:%s\n", buf);
    301            } else {
    302              printf("SendCmdFailed:%s\n", buf); 
   \   000097                ; Setup parameters for call to function printf
   \   000097   78..         MOV     R0,#?V0 + 0
   \   000099   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009C   7A..         MOV     R2,#`?<Constant "SendCmdFailed:%s\\n">` & 0xff
   \   00009E   7B..         MOV     R3,#(`?<Constant "SendCmdFailed:%s\\n">` >> 8) & 0xff
   \   0000A0   12....       LCALL   ?Subroutine3 & 0xFFFF
    303            }
   \                     ??CrossCallReturnLabel_8:
   \   0000A3   12....       LCALL   ?DEALLOC_XSTACK8
    304            
    305          }
   \                     ??SmartHome_SendCmd_3:
   \   0000A6   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    306          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    307          static void processUartCB(uint8* buf, uint8 len)
   \                     processUartCB:
    308          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
   \   000009   E9           MOV     A,R1
   \   00000A   FE           MOV     R6,A
    309            // process UART input
    310            if (Util_StrEqual(buf, "ReadName")) {
   \   00000B                ; Setup parameters for call to function Util_StrEqual
   \   00000B   7C..         MOV     R4,#`?<Constant "ReadName">` & 0xff
   \   00000D   7D..         MOV     R5,#(`?<Constant "ReadName">` >> 8) & 0xff
   \   00000F   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_42:
   \   000012   600C         JZ      ??processUartCB_0
    311              printf("ReadName:%s\n", Util_ReadName());
   \   000014                ; Setup parameters for call to function printf
   \   000014                ; Setup parameters for call to function Util_ReadName
   \   000014   12....       LCALL   ?Subroutine2 & 0xFFFF
    312            } else if (Util_StartWith(buf, "WriteName ")) {
   \                     ??CrossCallReturnLabel_2:
   \   000017   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001A   7A..         MOV     R2,#`?<Constant "ReadName:%s\\n">` & 0xff
   \   00001C   7B..         MOV     R3,#(`?<Constant "ReadName:%s\\n">` >> 8) & 0xff
   \   00001E   806A         SJMP    ??processUartCB_1
   \                     ??processUartCB_0:
   \   000020                ; Setup parameters for call to function Util_StartWith
   \   000020   7C..         MOV     R4,#`?<Constant "WriteName ">` & 0xff
   \   000022   7D..         MOV     R5,#(`?<Constant "WriteName ">` >> 8) & 0xff
   \   000024   AA..         MOV     R2,?V0 + 0
   \   000026   AB..         MOV     R3,?V0 + 1
   \   000028   12....       LCALL   ??Util_StartWith?relay
   \   00002B   E9           MOV     A,R1
   \   00002C   6021         JZ      ??processUartCB_2
    313              Util_WriteName(buf + 10, len - 9);
   \   00002E                ; Setup parameters for call to function Util_WriteName
   \   00002E   EE           MOV     A,R6
   \   00002F   24F7         ADD     A,#-0x9
   \   000031   FC           MOV     R4,A
   \   000032   E4           CLR     A
   \   000033   34FF         ADDC    A,#-0x1
   \   000035   FD           MOV     R5,A
   \   000036   E5..         MOV     A,?V0 + 0
   \   000038   240A         ADD     A,#0xa
   \   00003A   FA           MOV     R2,A
   \   00003B   E5..         MOV     A,?V0 + 1
   \   00003D   3400         ADDC    A,#0x0
   \   00003F   FB           MOV     R3,A
   \   000040   12....       LCALL   ??Util_WriteName?relay
    314              printf("WriteName:%s\n", Util_ReadName());
   \   000043                ; Setup parameters for call to function printf
   \   000043                ; Setup parameters for call to function Util_ReadName
   \   000043   12....       LCALL   ?Subroutine2 & 0xFFFF
    315            } else  if (Util_StrEqual(buf, "SystemReset")) {
   \                     ??CrossCallReturnLabel_3:
   \   000046   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000049   7A..         MOV     R2,#`?<Constant "WriteName:%s\\n">` & 0xff
   \   00004B   7B..         MOV     R3,#(`?<Constant "WriteName:%s\\n">` >> 8) & 0xff
   \   00004D   803B         SJMP    ??processUartCB_1
   \                     ??processUartCB_2:
   \   00004F                ; Setup parameters for call to function Util_StrEqual
   \   00004F   7C..         MOV     R4,#`?<Constant "SystemReset">` & 0xff
   \   000051   7D..         MOV     R5,#(`?<Constant "SystemReset">` >> 8) & 0xff
   \   000053   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_39:
   \   000056   600C         JZ      ??processUartCB_3
    316              SystemReset();
   \   000058   C2AF         CLR     0xa8.7
   \   00005A   C2AF         CLR     0xa8.7
   \   00005C   75C9AB       MOV     0xc9,#-0x55
   \   00005F   75C95B       MOV     0xc9,#0x5b
   \                     ??processUartCB_4:
   \   000062   80FE         SJMP    ??processUartCB_4
    317            } else if (Util_StartWith(buf, "SendCmd ")) {
   \                     ??processUartCB_3:
   \   000064                ; Setup parameters for call to function Util_StartWith
   \   000064   7C..         MOV     R4,#`?<Constant "SendCmd ">` & 0xff
   \   000066   7D..         MOV     R5,#(`?<Constant "SendCmd ">` >> 8) & 0xff
   \   000068   AA..         MOV     R2,?V0 + 0
   \   00006A   AB..         MOV     R3,?V0 + 1
   \   00006C   12....       LCALL   ??Util_StartWith?relay
   \   00006F   E9           MOV     A,R1
   \   000070   600F         JZ      ??processUartCB_5
    318              SmartHome_SendCmd(buf + 8);
   \   000072                ; Setup parameters for call to function SmartHome_SendCmd
   \   000072   E5..         MOV     A,?V0 + 0
   \   000074   2408         ADD     A,#0x8
   \   000076   FA           MOV     R2,A
   \   000077   E5..         MOV     A,?V0 + 1
   \   000079   3400         ADDC    A,#0x0
   \   00007B   FB           MOV     R3,A
   \   00007C   12....       LCALL   ??SmartHome_SendCmd?relay
   \   00007F   800F         SJMP    ??processUartCB_6
    319            } else {
    320              
    321              printf("Unkown Cmd:%s\n", buf); 
   \                     ??processUartCB_5:
   \   000081                ; Setup parameters for call to function printf
   \   000081   78..         MOV     R0,#?V0 + 0
   \   000083   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000086   7A..         MOV     R2,#`?<Constant "Unkown Cmd:%s\\n">` & 0xff
   \   000088   7B..         MOV     R3,#(`?<Constant "Unkown Cmd:%s\\n">` >> 8) & 0xff
    322            }
   \                     ??processUartCB_1:
   \   00008A   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   00008D   12....       LCALL   ?DEALLOC_XSTACK8
    323            
    324            
    325          }
   \                     ??processUartCB_6:
   \   000090   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   000093                REQUIRE _A_IEN0
   \   000093                REQUIRE WDCTL

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   AA..         MOV     R2,?V0 + 0
   \   000002   AB..         MOV     R3,?V0 + 1
   \   000004                REQUIRE ??Subroutine14_0
   \   000004                ; // Fall through to label ??Subroutine14_0
    326          
    327          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    328          static void SmartHomeApp_CallBack(uint8 port, uint8 event)
   \                     SmartHomeApp_CallBack:
    329          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
    330            (void)port;
    331            
    332            if ((event & (HAL_UART_RX_FULL | HAL_UART_RX_ABOUT_FULL | HAL_UART_RX_TIMEOUT)) &&
    333          #if SERIAL_APP_LOOPBACK
    334                (SerialApp_TxLen < SERIAL_APP_TX_MAX))
    335          #else
    336                !SerialApp_TxLen)
   \   000007   7407         MOV     A,#0x7
   \   000009   5E           ANL     A,R6
   \   00000A   6039         JZ      ??SmartHomeApp_CallBack_0
   \   00000C   90....       MOV     DPTR,#SerialApp_TxLen
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   7033         JNZ     ??SmartHomeApp_CallBack_0
    337          #endif
    338            {
    339              SerialApp_TxLen = HalUARTRead(0, RxBuf, SERIAL_APP_TX_MAX);
   \   000012                ; Setup parameters for call to function HalUARTRead
   \   000012   7C40         MOV     R4,#0x40
   \   000014   7D00         MOV     R5,#0x0
   \   000016   7A..         MOV     R2,#RxBuf & 0xff
   \   000018   7B..         MOV     R3,#(RxBuf >> 8) & 0xff
   \   00001A   7900         MOV     R1,#0x0
   \   00001C   12....       LCALL   ??HalUARTRead?relay
   \   00001F   EA           MOV     A,R2
   \   000020   90....       MOV     DPTR,#SerialApp_TxLen
   \   000023   F0           MOVX    @DPTR,A
    340              if (SerialApp_TxLen)
   \   000024   601F         JZ      ??SmartHomeApp_CallBack_0
    341              {
    342                RxBuf[SerialApp_TxLen] = 0;
   \   000026   F8           MOV     R0,A
   \   000027   74..         MOV     A,#RxBuf & 0xff
   \   000029   28           ADD     A,R0
   \   00002A   F582         MOV     DPL,A
   \   00002C   74..         MOV     A,#(RxBuf >> 8) & 0xff
   \   00002E   3400         ADDC    A,#0x0
   \   000030   F583         MOV     DPH,A
   \   000032   E4           CLR     A
   \   000033   F0           MOVX    @DPTR,A
    343                processUartCB(RxBuf, SerialApp_TxLen);
   \   000034                ; Setup parameters for call to function processUartCB
   \   000034   90....       MOV     DPTR,#SerialApp_TxLen
   \   000037   E0           MOVX    A,@DPTR
   \   000038   F9           MOV     R1,A
   \   000039   7A..         MOV     R2,#RxBuf & 0xff
   \   00003B   7B..         MOV     R3,#(RxBuf >> 8) & 0xff
   \   00003D   12....       LCALL   ??processUartCB?relay
    344                  
    345               
    346                SerialApp_TxLen=0;
   \   000040   90....       MOV     DPTR,#SerialApp_TxLen
   \   000043   E4           CLR     A
   \   000044   F0           MOVX    @DPTR,A
    347              }
    348            }
    349            
    350          
    351          //  if ((event & (HAL_UART_RX_FULL | HAL_UART_RX_ABOUT_FULL | HAL_UART_RX_TIMEOUT)) &&
    352          //#if SERIAL_APP_LOOPBACK
    353          //      (SerialApp_TxLen < SERIAL_APP_TX_MAX))
    354          //#else
    355          //      !SerialApp_TxLen)
    356          //#endif
    357          //  {
    358          //    SerialApp_Send();
    359          //  }
    360          }
   \                     ??SmartHomeApp_CallBack_0:
   \   000045   7F01         MOV     R7,#0x1
   \   000047   02....       LJMP    ?BANKED_LEAVE_XDATA
    361          
    362          /*********************************************************************
    363           * @fn      SmartHomeApp_ProcessEvent
    364           *
    365           * @brief   Generic Application Task event processor.  This function
    366           *          is called to process all events for the task.  Events
    367           *          include timers, messages and any other user defined events.
    368           *
    369           * @param   task_id  - The OSAL assigned task ID.
    370           * @param   events - events to process.  This is a bit map and can
    371           *                   contain more than one event.
    372           *
    373           * @return  none
    374           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    375          uint16 SmartHomeApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     SmartHomeApp_ProcessEvent:
    376          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    377            afIncomingMSGPacket_t *MSGpkt;
    378            afDataConfirm_t *afDataConfirm;
    379          
    380            // Data Confirmation message fields
    381            byte sentEP;
    382            ZStatus_t sentStatus;
    383            byte sentTransID;       // This should match the value sent
    384            (void)task_id;  // Intentionally unreferenced parameter
    385          
    386            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   7003         JNZ     $+5
   \   00000D   02....       LJMP    ??SmartHomeApp_ProcessEvent_0 & 0xFFFF
    387            {
    388              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SmartHomeApp_TaskID );
   \   000010                ; Setup parameters for call to function osal_msg_receive
   \   000010   804F         SJMP    ??SmartHomeApp_ProcessEvent_1
    389              while ( MSGpkt )
    390              {
    391                switch ( MSGpkt->hdr.event )
    392                {
    393                  case ZDO_CB_MSG:
    394                    SmartHomeApp_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
    395                    break;
    396          
    397                  case KEY_CHANGE:
    398                    SmartHomeApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    399                    break;
    400          
    401                  case AF_DATA_CONFIRM_CMD:
    402                    // This message is received as a confirmation of a data packet sent.
    403                    // The status is of ZStatus_t type [defined in ZComDef.h]
    404                    // The message fields are defined in AF.h
    405                    afDataConfirm = (afDataConfirm_t *)MSGpkt;
    406                    sentEP = afDataConfirm->endpoint;
    407                    sentStatus = afDataConfirm->hdr.status;
    408                    sentTransID = afDataConfirm->transID;
    409                    (void)sentEP;
    410                    (void)sentTransID;
    411          
    412                    // Action taken when confirmation is received.
    413                    if ( sentStatus != ZSuccess )
    414                    {
    415                      // The data wasn't delivered -- Do something
    416                      printf("SendMsgFailed:%X\n", sentTransID);
    417                      if (SmartHomeApp_LastSendTransID == sentTransID) {
    418                        NameAddrCache_delete(SmartHomeApp_LastSendAddr);
    419                      }
    420                      
    421                    } else {
    422                      printf("SendMsgOK:%X\n", sentTransID);
    423                      
    424                    }
    425                    break;
    426          
    427                  case AF_INCOMING_MSG_CMD:
    428                    SmartHomeApp_MessageMSGCB( MSGpkt );
    429                    break;
    430          
    431                  case ZDO_STATE_CHANGE:
    432                    SmartHomeApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??SmartHomeApp_ProcessEvent_2:
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   90....       MOV     DPTR,#SmartHomeApp_NwkState
   \   000017   F0           MOVX    @DPTR,A
    433                    if ( (SmartHomeApp_NwkState == DEV_ZB_COORD)
    434                        || (SmartHomeApp_NwkState == DEV_ROUTER)
    435                        || (SmartHomeApp_NwkState == DEV_END_DEVICE) )
   \   000018   6409         XRL     A,#0x9
   \   00001A   600A         JZ      ??SmartHomeApp_ProcessEvent_3
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   6407         XRL     A,#0x7
   \   00001F   6005         JZ      ??SmartHomeApp_ProcessEvent_3
   \   000021   E0           MOVX    A,@DPTR
   \   000022   6406         XRL     A,#0x6
   \   000024   7034         JNZ     ??SmartHomeApp_ProcessEvent_4
    436                    {
    437                      
    438                      uint16 shortAddr = NLME_GetShortAddr();
   \                     ??SmartHomeApp_ProcessEvent_3:
   \   000026                ; Setup parameters for call to function NLME_GetShortAddr
   \   000026   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000029   8A..         MOV     ?V0 + 2,R2
   \   00002B   8B..         MOV     ?V0 + 3,R3
    439                      uint16 parentShortAddr = NLME_GetCoordShortAddr();
    440                      
    441                      printf("Addr=%04X, ParentAddr=%04X\n", shortAddr, parentShortAddr);
   \   00002D                ; Setup parameters for call to function printf
   \   00002D                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   00002D   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   000030   8A..         MOV     ?V0 + 4,R2
   \   000032   8B..         MOV     ?V0 + 5,R3
   \   000034   78..         MOV     R0,#?V0 + 4
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   78..         MOV     R0,#?V0 + 2
   \   00003B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003E   7A..         MOV     R2,#`?<Constant "Addr=%04X, ParentAddr...">` & 0xff
   \   000040   7B..         MOV     R3,#(`?<Constant "Addr=%04X, ParentAddr...">` >> 8) & 0xff
   \   000042   12....       LCALL   ??printf?relay
   \   000045   7404         MOV     A,#0x4
   \   000047   12....       LCALL   ?DEALLOC_XSTACK8
    442                      
    443          //            printf("BV(4) = %X, BV(5) = %X, BV(6) = %X\n", BV(4), BV(5), BV(6));
    444          //            printf("P0_4 = %X, P0_5 = %X, P0_6 = %X\n", P0_4, P0_5, P0_6);
    445          //            
    446                      // Start sending "the" message in a regular interval.
    447          //            osal_start_timerEx( SmartHomeApp_TaskID,
    448          //                                SmartHomeApp_SEND_MSG_EVT,
    449          //                                SmartHomeApp_SEND_MSG_TIMEOUT );
    450                      
    451                      osal_start_timerEx( SmartHomeApp_TaskID,
    452                                  SmartHomeApp_TIMER_UPDATE_EVT,
    453                                  1000 );
   \   00004A                ; Setup parameters for call to function osal_start_timerEx
   \   00004A   7CE8         MOV     R4,#-0x18
   \   00004C   7D03         MOV     R5,#0x3
   \   00004E   7A02         MOV     R2,#0x2
   \   000050   7B00         MOV     R3,#0x0
   \   000052   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   000055   E0           MOVX    A,@DPTR
   \   000056   F9           MOV     R1,A
   \   000057   12....       LCALL   ??osal_start_timerEx?relay
    454                    }
    455                    break;
    456          
    457                  default:
    458                    break;
    459                }
    460          
    461                // Release the memory
    462                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??SmartHomeApp_ProcessEvent_4:
   \   00005A                ; Setup parameters for call to function osal_msg_deallocate
   \   00005A   AA..         MOV     R2,?V0 + 0
   \   00005C   AB..         MOV     R3,?V0 + 1
   \   00005E   12....       LCALL   ??osal_msg_deallocate?relay
    463          
    464                // Next
    465                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SmartHomeApp_TaskID );
   \   000061                ; Setup parameters for call to function osal_msg_receive
   \                     ??SmartHomeApp_ProcessEvent_1:
   \   000061   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   000064   E0           MOVX    A,@DPTR
   \   000065   F9           MOV     R1,A
   \   000066   12....       LCALL   ??osal_msg_receive?relay
   \   000069   8A..         MOV     ?V0 + 0,R2
   \   00006B   8B..         MOV     ?V0 + 1,R3
   \   00006D   E5..         MOV     A,?V0 + 0
   \   00006F   45..         ORL     A,?V0 + 1
   \   000071   7003         JNZ     $+5
   \   000073   02....       LJMP    ??SmartHomeApp_ProcessEvent_5 & 0xFFFF
   \   000076   85..82       MOV     DPL,?V0 + 0
   \   000079   85..83       MOV     DPH,?V0 + 1
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   24E6         ADD     A,#-0x1a
   \   00007F   7003         JNZ     $+5
   \   000081   02....       LJMP    ??SmartHomeApp_ProcessEvent_6 & 0xFFFF
   \   000084   245A         ADD     A,#0x5a
   \   000086   7003         JNZ     $+5
   \   000088   02....       LJMP    ??SmartHomeApp_ProcessEvent_7 & 0xFFFF
   \   00008B   24EF         ADD     A,#-0x11
   \   00008D   6083         JZ      ??SmartHomeApp_ProcessEvent_2
   \   00008F   24FE         ADD     A,#-0x2
   \   000091   6009         JZ      ??SmartHomeApp_ProcessEvent_8
   \   000093   24D6         ADD     A,#-0x2a
   \   000095   7003         JNZ     $+5
   \   000097   02....       LJMP    ??SmartHomeApp_ProcessEvent_9 & 0xFFFF
   \   00009A   80BE         SJMP    ??SmartHomeApp_ProcessEvent_4
   \                     ??SmartHomeApp_ProcessEvent_8:
   \   00009C   E5..         MOV     A,?V0 + 0
   \   00009E   240C         ADD     A,#0xc
   \   0000A0   F582         MOV     DPL,A
   \   0000A2   E5..         MOV     A,?V0 + 1
   \   0000A4   12....       LCALL   ??Subroutine16_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_45:
   \   0000A7   F5..         MOV     ?V0 + 2,A
   \   0000A9   A3           INC     DPTR
   \   0000AA   E0           MOVX    A,@DPTR
   \   0000AB   F5..         MOV     ?V0 + 3,A
   \   0000AD   78..         MOV     R0,#?V0 + 2
   \   0000AF   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for SmartHomeApp_ProcessEvent>_0`:
   \   0000B2   0000         DW        0
   \   0000B4   0200         DW        2
   \   0000B6   0680         DW        32774
   \   0000B8   ....         DW        ??SmartHomeApp_ProcessEvent_10
   \   0000BA   2080         DW        32800
   \   0000BC   ....         DW        ??SmartHomeApp_ProcessEvent_11
   \   0000BE   ....         DW        ??SmartHomeApp_ProcessEvent_4
   \                     ??SmartHomeApp_ProcessEvent_10:
   \   0000C0                ; Setup parameters for call to function ZDO_ParseEPListRsp
   \   0000C0   AA..         MOV     R2,?V0 + 0
   \   0000C2   AB..         MOV     R3,?V0 + 1
   \   0000C4   12....       LCALL   ??ZDO_ParseEPListRsp?relay
   \   0000C7   8A..         MOV     ?V0 + 2,R2
   \   0000C9   8B..         MOV     ?V0 + 3,R3
   \   0000CB   EA           MOV     A,R2
   \   0000CC   45..         ORL     A,?V0 + 3
   \   0000CE   608A         JZ      ??SmartHomeApp_ProcessEvent_4
   \   0000D0   8A82         MOV     DPL,R2
   \   0000D2   8B83         MOV     DPH,R3
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   7022         JNZ     ??SmartHomeApp_ProcessEvent_12
   \   0000D7   A3           INC     DPTR
   \   0000D8   A3           INC     DPTR
   \   0000D9   A3           INC     DPTR
   \   0000DA   E0           MOVX    A,@DPTR
   \   0000DB   601C         JZ      ??SmartHomeApp_ProcessEvent_12
   \   0000DD   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 8
   \   0000E0   7402         MOV     A,#0x2
   \   0000E2   F0           MOVX    @DPTR,A
   \   0000E3   8A82         MOV     DPL,R2
   \   0000E5   8B83         MOV     DPH,R3
   \   0000E7   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   0000EA   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   0000ED   E0           MOVX    A,@DPTR
   \   0000EE   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 9
   \   0000F1   F0           MOVX    @DPTR,A
   \   0000F2                ; Setup parameters for call to function HalLedSet
   \   0000F2   7A01         MOV     R2,#0x1
   \   0000F4   7908         MOV     R1,#0x8
   \   0000F6   12....       LCALL   ??HalLedSet?relay
   \                     ??SmartHomeApp_ProcessEvent_12:
   \   0000F9                ; Setup parameters for call to function osal_mem_free
   \   0000F9   AA..         MOV     R2,?V0 + 2
   \   0000FB   AB..         MOV     R3,?V0 + 3
   \   0000FD   12....       LCALL   ??osal_mem_free?relay
   \   000100   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
   \                     ??SmartHomeApp_ProcessEvent_11:
   \   000103   E5..         MOV     A,?V0 + 0
   \   000105   2413         ADD     A,#0x13
   \   000107   F582         MOV     DPL,A
   \   000109   E5..         MOV     A,?V0 + 1
   \   00010B   3400         ADDC    A,#0x0
   \   00010D   F583         MOV     DPH,A
   \   00010F   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   000112   E0           MOVX    A,@DPTR
   \   000113   700A         JNZ     ??SmartHomeApp_ProcessEvent_13
   \   000115                ; Setup parameters for call to function HalLedSet
   \   000115   7A01         MOV     R2,#0x1
   \                     ??SmartHomeApp_ProcessEvent_14:
   \   000117   7908         MOV     R1,#0x8
   \   000119   12....       LCALL   ??HalLedSet?relay
   \   00011C   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
   \                     ??SmartHomeApp_ProcessEvent_13:
   \   00011F                ; Setup parameters for call to function HalLedSet
   \   00011F   7A04         MOV     R2,#0x4
   \   000121   80F4         SJMP    ??SmartHomeApp_ProcessEvent_14
   \                     ??SmartHomeApp_ProcessEvent_7:
   \   000123                ; Setup parameters for indirect call
   \   000123   A3           INC     DPTR
   \   000124   A3           INC     DPTR
   \   000125   A3           INC     DPTR
   \   000126   E0           MOVX    A,@DPTR
   \   000127   F9           MOV     R1,A
   \   000128   90....       MOV     DPTR,#Processor_HandleKeys
   \   00012B   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   00012E   12....       LCALL   ?CALL_IND
   \   000131   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
   \                     ??SmartHomeApp_ProcessEvent_9:
   \   000134   A3           INC     DPTR
   \   000135   A3           INC     DPTR
   \   000136   A3           INC     DPTR
   \   000137   E0           MOVX    A,@DPTR
   \   000138   F5..         MOV     ?V0 + 4,A
   \   00013A   85..82       MOV     DPL,?V0 + 0
   \   00013D   85..83       MOV     DPH,?V0 + 1
   \   000140   A3           INC     DPTR
   \   000141   E0           MOVX    A,@DPTR
   \   000142   85....       MOV     ?V0 + 2,?V0 + 4
   \   000145   75..00       MOV     ?V0 + 3,#0x0
   \   000148   78..         MOV     R0,#?V0 + 2
   \   00014A   602A         JZ      ??SmartHomeApp_ProcessEvent_15
   \   00014C                ; Setup parameters for call to function printf
   \   00014C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00014F   7A..         MOV     R2,#`?<Constant "SendMsgFailed:%X\\n">` & 0xff
   \   000151   7B..         MOV     R3,#(`?<Constant "SendMsgFailed:%X\\n">` >> 8) & 0xff
   \   000153   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   000156   12....       LCALL   ?DEALLOC_XSTACK8
   \   000159   90....       MOV     DPTR,#SmartHomeApp_LastSendTransID
   \   00015C   E0           MOVX    A,@DPTR
   \   00015D   65..         XRL     A,?V0 + 4
   \   00015F   7002         JNZ     ??SmartHomeApp_ProcessEvent_16
   \   000161   A3           INC     DPTR
   \   000162   E0           MOVX    A,@DPTR
   \                     ??SmartHomeApp_ProcessEvent_16:
   \   000163   6003         JZ      $+5
   \   000165   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
   \   000168                ; Setup parameters for call to function NameAddrCache_delete
   \   000168   90....       MOV     DPTR,#SmartHomeApp_LastSendAddr
   \   00016B   E0           MOVX    A,@DPTR
   \   00016C   FA           MOV     R2,A
   \   00016D   A3           INC     DPTR
   \   00016E   E0           MOVX    A,@DPTR
   \   00016F   FB           MOV     R3,A
   \   000170   12....       LCALL   ??NameAddrCache_delete?relay
   \   000173   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
   \                     ??SmartHomeApp_ProcessEvent_15:
   \   000176                ; Setup parameters for call to function printf
   \   000176   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000179   7A..         MOV     R2,#`?<Constant "SendMsgOK:%X\\n">` & 0xff
   \   00017B   7B..         MOV     R3,#(`?<Constant "SendMsgOK:%X\\n">` >> 8) & 0xff
   \   00017D   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   000180   12....       LCALL   ?DEALLOC_XSTACK8
   \   000183   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
   \                     ??SmartHomeApp_ProcessEvent_6:
   \   000186                ; Setup parameters for call to function SmartHomeApp_MessageMSGCB
   \   000186   AA..         MOV     R2,?V0 + 0
   \   000188   AB..         MOV     R3,?V0 + 1
   \   00018A   12....       LCALL   ??SmartHomeApp_MessageMSGCB?relay
   \   00018D   02....       LJMP    ??SmartHomeApp_ProcessEvent_4 & 0xFFFF
    466              }
    467          
    468              // return unprocessed events
    469              return (events ^ SYS_EVENT_MSG);
   \                     ??SmartHomeApp_ProcessEvent_5:
   \   000190   EE           MOV     A,R6
   \   000191   FA           MOV     R2,A
   \   000192   EF           MOV     A,R7
   \   000193   6480         XRL     A,#0x80
   \                     ??SmartHomeApp_ProcessEvent_17:
   \   000195   FB           MOV     R3,A
   \   000196   8029         SJMP    ??SmartHomeApp_ProcessEvent_18
    470            }
    471          
    472            // Send a message out - This event is generated by a timer
    473            //  (setup in SmartHomeApp_Init()).
    474          //  if ( events & SmartHomeApp_SEND_MSG_EVT )
    475          //  {
    476          //    // Send "the" message
    477          //    SmartHomeApp_SendTheMessage();
    478          //
    479          //    // Setup to send message again
    480          //    osal_start_timerEx( SmartHomeApp_TaskID,
    481          //                        SmartHomeApp_SEND_MSG_EVT,
    482          //                        SmartHomeApp_SEND_MSG_TIMEOUT );
    483          //
    484          //    // return unprocessed events
    485          //    return (events ^ SmartHomeApp_SEND_MSG_EVT);
    486          //  }
    487          
    488            if ( events & SmartHomeApp_TIMER_UPDATE_EVT )
   \                     ??SmartHomeApp_ProcessEvent_0:
   \   000198   EE           MOV     A,R6
   \   000199   5402         ANL     A,#0x2
   \   00019B   6020         JZ      ??SmartHomeApp_ProcessEvent_19
    489            {
    490              
    491              Processor_Update();
   \   00019D                ; Setup parameters for indirect call
   \   00019D   90....       MOV     DPTR,#Processor_Update
   \   0001A0   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   0001A3   12....       LCALL   ?CALL_IND
    492              // Setup to send message again
    493              osal_start_timerEx( SmartHomeApp_TaskID,
    494                                  SmartHomeApp_TIMER_UPDATE_EVT,
    495                                  1000 );
   \   0001A6                ; Setup parameters for call to function osal_start_timerEx
   \   0001A6   7CE8         MOV     R4,#-0x18
   \   0001A8   7D03         MOV     R5,#0x3
   \   0001AA   7A02         MOV     R2,#0x2
   \   0001AC   7B00         MOV     R3,#0x0
   \   0001AE   90....       MOV     DPTR,#SmartHomeApp_TaskID
   \   0001B1   E0           MOVX    A,@DPTR
   \   0001B2   F9           MOV     R1,A
   \   0001B3   12....       LCALL   ??osal_start_timerEx?relay
    496          
    497              // return unprocessed events
    498              return (events ^ SmartHomeApp_TIMER_UPDATE_EVT);
   \   0001B6   EE           MOV     A,R6
   \   0001B7   6402         XRL     A,#0x2
   \   0001B9   FA           MOV     R2,A
   \   0001BA   EF           MOV     A,R7
   \   0001BB   80D8         SJMP    ??SmartHomeApp_ProcessEvent_17
    499            }
    500            
    501          
    502            // Discard unknown events
    503            return 0;
   \                     ??SmartHomeApp_ProcessEvent_19:
   \   0001BD   7A00         MOV     R2,#0x0
   \   0001BF   7B00         MOV     R3,#0x0
   \                     ??SmartHomeApp_ProcessEvent_18:
   \   0001C1                REQUIRE ?Subroutine1
   \   0001C1                ; // Fall through to label ?Subroutine1
    504          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F06         MOV     R7,#0x6
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   A3           INC     DPTR
   \   000001   E0           MOVX    A,@DPTR
   \   000002   F8           MOV     R0,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   F9           MOV     R1,A
   \   000006   90....       MOV     DPTR,#SmartHomeApp_DstAddr
   \   000009   E8           MOV     A,R0
   \   00000A   F0           MOVX    @DPTR,A
   \   00000B   A3           INC     DPTR
   \   00000C   E9           MOV     A,R1
   \   00000D   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   8A82         MOV     DPL,R2
   \   000003   8B83         MOV     DPH,R3
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine16_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET
    505          
    506          /*********************************************************************
    507           * Event Generation Functions
    508           */
    509          
    510          /*********************************************************************
    511           * @fn      SmartHomeApp_ProcessZDOMsgs()
    512           *
    513           * @brief   Process response messages
    514           *
    515           * @param   none
    516           *
    517           * @return  none
    518           */
    519          static void SmartHomeApp_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
    520          {
    521            switch ( inMsg->clusterID )
    522            {
    523              case End_Device_Bind_rsp:
    524                if ( ZDO_ParseBindRsp( inMsg ) == ZSuccess )
    525                {
    526                  // Light LED
    527                  HalLedSet( HAL_LED_4, HAL_LED_MODE_ON );
    528                }
    529          #if defined( BLINK_LEDS )
    530                else
    531                {
    532                  // Flash LED to show failure
    533                  HalLedSet ( HAL_LED_4, HAL_LED_MODE_FLASH );
    534                }
    535          #endif
    536                break;
    537          
    538              case Match_Desc_rsp:
    539                {
    540                  ZDO_ActiveEndpointRsp_t *pRsp = ZDO_ParseEPListRsp( inMsg );
    541                  if ( pRsp )
    542                  {
    543                    if ( pRsp->status == ZSuccess && pRsp->cnt )
    544                    {
    545                      SmartHomeApp_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
    546                      SmartHomeApp_DstAddr.addr.shortAddr = pRsp->nwkAddr;
    547                      // Take the first endpoint, Can be changed to search through endpoints
    548                      SmartHomeApp_DstAddr.endPoint = pRsp->epList[0];
    549          
    550                      // Light LED
    551                      HalLedSet( HAL_LED_4, HAL_LED_MODE_ON );
    552                    }
    553                    osal_mem_free( pRsp );
    554                  }
    555                }
    556                break;
    557            }
    558          }
    559          
    560          /*********************************************************************
    561           * @fn      SmartHomeApp_HandleKeys
    562           *
    563           * @brief   Handles all key events for this device.
    564           *
    565           * @param   shift - true if in shift/alt.
    566           * @param   keys - bit field for key events. Valid entries:
    567           *                 HAL_KEY_SW_4
    568           *                 HAL_KEY_SW_3
    569           *                 HAL_KEY_SW_2
    570           *                 HAL_KEY_SW_1
    571           *
    572           * @return  none
    573           */
    574          static void SmartHomeApp_HandleKeys( uint8 shift, uint8 keys )
    575          {
    576          //  zAddrType_t dstAddr;
    577            
    578            Processor_HandleKeys(keys);
    579          
    580          //  // Shift is used to make each button/switch dual purpose.
    581          //  if ( shift )
    582          //  {
    583          //    if ( keys & HAL_KEY_SW_1 )
    584          //    {
    585          //    }
    586          //    if ( keys & HAL_KEY_SW_2 )
    587          //    {
    588          //    }
    589          //    if ( keys & HAL_KEY_SW_3 )
    590          //    {
    591          //    }
    592          //    if ( keys & HAL_KEY_SW_4 )
    593          //    {
    594          //    }
    595          //  }
    596          //  else
    597          //  {
    598          //    if ( keys & HAL_KEY_SW_1 )
    599          //    {
    600          //      // Since SW1 isn't used for anything else in this application...
    601          //#if defined( SWITCH1_BIND )
    602          //      // we can use SW1 to simulate SW2 for devices that only have one switch,
    603          //      keys |= HAL_KEY_SW_2;
    604          //#elif defined( SWITCH1_MATCH )
    605          //      // or use SW1 to simulate SW4 for devices that only have one switch
    606          //      keys |= HAL_KEY_SW_4;
    607          //#endif
    608          //    }
    609          //
    610          //    if ( keys & HAL_KEY_SW_2 )
    611          //    {
    612          //      HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
    613          //
    614          //      // Initiate an End Device Bind Request for the mandatory endpoint
    615          //      dstAddr.addrMode = Addr16Bit;
    616          //      dstAddr.addr.shortAddr = 0x0000; // Coordinator
    617          //      ZDP_EndDeviceBindReq( &dstAddr, NLME_GetShortAddr(),
    618          //                            SmartHomeApp_epDesc.endPoint,
    619          //                            SmartHomeApp_PROFID,
    620          //                            SmartHomeApp_MAX_CLUSTERS, (cId_t *)SmartHomeApp_ClusterList,
    621          //                            SmartHomeApp_MAX_CLUSTERS, (cId_t *)SmartHomeApp_ClusterList,
    622          //                            FALSE );
    623          //    }
    624          //
    625          //    if ( keys & HAL_KEY_SW_3 )
    626          //    {
    627          //    }
    628          //
    629          //    if ( keys & HAL_KEY_SW_4 )
    630          //    {
    631          //      HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
    632          //      // Initiate a Match Description Request (Service Discovery)
    633          //      dstAddr.addrMode = AddrBroadcast;
    634          //      dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
    635          //      ZDP_MatchDescReq( &dstAddr, NWK_BROADCAST_SHORTADDR,
    636          //                        SmartHomeApp_PROFID,
    637          //                        SmartHomeApp_MAX_CLUSTERS, (cId_t *)SmartHomeApp_ClusterList,
    638          //                        SmartHomeApp_MAX_CLUSTERS, (cId_t *)SmartHomeApp_ClusterList,
    639          //                        FALSE );
    640          //    }
    641          //  }
    642          }
    643          
    644          /*********************************************************************
    645           * LOCAL FUNCTIONS
    646           */
    647          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    648          static void SmartHomeApp_ProcessReportNames(afIncomingMSGPacket_t *inMsg)
   \                     SmartHomeApp_ProcessReportNames:
    649          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 48
   \   000005   74D0         MOV     A,#-0x30
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    650            uint16 shortAddr = NLME_GetShortAddr();
   \   00000E                ; Setup parameters for call to function NLME_GetShortAddr
   \   00000E   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000011   8A..         MOV     ?V0 + 0,R2
   \   000013   8B..         MOV     ?V0 + 1,R3
    651            uint16 parentShortAddr = NLME_GetCoordShortAddr();
   \   000015                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   000015   12....       LCALL   ??NLME_GetCoordShortAddr?relay
   \   000018   8A..         MOV     ?V0 + 2,R2
   \   00001A   8B..         MOV     ?V0 + 3,R3
    652            char buf[48];
    653            int len = sprintf(buf, "ReportNamesResp %s %04X %04X", Util_ReadName(), shortAddr, parentShortAddr);
   \   00001C                ; Setup parameters for call to function sprintf
   \   00001C   78..         MOV     R0,#?V0 + 2
   \   00001E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000021   78..         MOV     R0,#?V0 + 0
   \   000023   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000026                ; Setup parameters for call to function Util_ReadName
   \   000026   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   000029   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002C   7C..         MOV     R4,#`?<Constant "ReportNamesResp %s %0...">` & 0xff
   \   00002E   7D..         MOV     R5,#(`?<Constant "ReportNamesResp %s %0...">` >> 8) & 0xff
   \   000030   7406         MOV     A,#0x6
   \   000032   12....       LCALL   ?XSTACK_DISP0_8
   \   000035   AA82         MOV     R2,DPL
   \   000037   AB83         MOV     R3,DPH
   \   000039   12....       LCALL   ??sprintf?relay
   \   00003C   7406         MOV     A,#0x6
   \   00003E   12....       LCALL   ?DEALLOC_XSTACK8
    654            
    655            SmartHomeApp_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   000041   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 8
   \   000044   7402         MOV     A,#0x2
   \   000046   F0           MOVX    @DPTR,A
    656            SmartHomeApp_DstAddr.endPoint = SmartHomeApp_ENDPOINT;
   \   000047   A3           INC     DPTR
   \   000048   740A         MOV     A,#0xa
   \   00004A   F0           MOVX    @DPTR,A
    657            SmartHomeApp_DstAddr.addr.shortAddr = inMsg->srcAddr.addr.shortAddr;
   \   00004B   8E82         MOV     DPL,R6
   \   00004D   8F83         MOV     DPH,R7
   \   00004F   A3           INC     DPTR
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   12....       LCALL   ?Subroutine10 & 0xFFFF
    658            
    659              
    660            if ( AF_DataRequest( &SmartHomeApp_DstAddr, &SmartHomeApp_epDesc,
    661                                 SmartHomeApp_CLUSTERID,
    662                                 osal_strlen(buf)+1,
    663                                 (uint8*)buf,
    664                                 &SmartHomeApp_TransID,
    665                                 AF_DISCV_ROUTE, AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \                     ??CrossCallReturnLabel_33:
   \   000056                ; Setup parameters for call to function AF_DataRequest
   \   000056   75..1E       MOV     ?V0 + 0,#0x1e
   \   000059   78..         MOV     R0,#?V0 + 0
   \   00005B   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00005E   75....       MOV     ?V0 + 0,#SmartHomeApp_TransID & 0xff
   \   000061   75....       MOV     ?V0 + 1,#(SmartHomeApp_TransID >> 8) & 0xff
   \   000064   78..         MOV     R0,#?V0 + 0
   \   000066   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000069   7403         MOV     A,#0x3
   \   00006B   12....       LCALL   ?XSTACK_DISP0_8
   \   00006E   8582..       MOV     ?V0 + 0,DPL
   \   000071   8583..       MOV     ?V0 + 1,DPH
   \   000074   78..         MOV     R0,#?V0 + 0
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079                ; Setup parameters for call to function osal_strlen
   \   000079   7405         MOV     A,#0x5
   \   00007B   12....       LCALL   ?XSTACK_DISP0_8
   \   00007E   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_31:
   \   000081   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000084   75..01       MOV     ?V0 + 0,#0x1
   \   000087   75..00       MOV     ?V0 + 1,#0x0
   \   00008A   78..         MOV     R0,#?V0 + 0
   \   00008C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008F   7920         MOV     R1,#0x20
   \   000091   7C..         MOV     R4,#SmartHomeApp_epDesc & 0xff
   \   000093   7D..         MOV     R5,#(SmartHomeApp_epDesc >> 8) & 0xff
   \   000095   7A..         MOV     R2,#SmartHomeApp_DstAddr & 0xff
   \   000097   7B..         MOV     R3,#(SmartHomeApp_DstAddr >> 8) & 0xff
   \   000099   12....       LCALL   ??AF_DataRequest?relay
   \   00009C   7409         MOV     A,#0x9
   \   00009E   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A1   E9           MOV     A,R1
   \   0000A2   601B         JZ      ??SmartHomeApp_ProcessReportNames_0
    666            {
    667              // Successfully requested to be sent.
    668            }
    669            else
    670            {
    671              printf("send ReportNamesResp error %s\n", buf);
   \   0000A4                ; Setup parameters for call to function printf
   \   0000A4   85..82       MOV     DPL,?XSP + 0
   \   0000A7   85..83       MOV     DPH,?XSP + 1
   \   0000AA   8582..       MOV     ?V0 + 0,DPL
   \   0000AD   8583..       MOV     ?V0 + 1,DPH
   \   0000B0   78..         MOV     R0,#?V0 + 0
   \   0000B2   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B5   7A..         MOV     R2,#`?<Constant "send ReportNamesResp ...">` & 0xff
   \   0000B7   7B..         MOV     R3,#(`?<Constant "send ReportNamesResp ...">` >> 8) & 0xff
   \   0000B9   12....       LCALL   ?Subroutine3 & 0xFFFF
    672            }
   \                     ??CrossCallReturnLabel_12:
   \   0000BC   12....       LCALL   ?DEALLOC_XSTACK8
    673            
    674          }
   \                     ??SmartHomeApp_ProcessReportNames_0:
   \   0000BF   7430         MOV     A,#0x30
   \   0000C1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000C4   02....       LJMP    ?Subroutine1 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   A3           INC     DPTR
   \   000001   12....       LCALL   ?Subroutine12 & 0xFFFF
   \                     ??CrossCallReturnLabel_36:
   \   000004   F0           MOVX    @DPTR,A
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   AA82         MOV     R2,DPL
   \   000002   AB83         MOV     R3,DPH
   \   000004   12....       LCALL   ??osal_strlen?relay
   \   000007   EA           MOV     A,R2
   \   000008   2401         ADD     A,#0x1
   \   00000A   F5..         MOV     ?V0 + 0,A
   \   00000C   EB           MOV     A,R3
   \   00000D   3400         ADDC    A,#0x0
   \   00000F   F5..         MOV     ?V0 + 1,A
   \   000011   78..         MOV     R0,#?V0 + 0
   \   000013   22           RET
    675          
    676          /**
    677           save name addr map 
    678          */
    679          void SmartHomeApp_ProcessNameAddrMapResp(uint8* data);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    680          void SmartHomeApp_ProcessNameAddrMapResp(uint8* data)
   \                     SmartHomeApp_ProcessNameAddrMapResp:
    681          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
    682             //NameAddrMap 1234 name
    683            if (osal_strlen((char*)data) < 18|| osal_strlen((char*)data) > 38) {
   \   000009                ; Setup parameters for call to function osal_strlen
   \   000009   12....       LCALL   ??osal_strlen?relay
   \   00000C   C3           CLR     C
   \   00000D   EA           MOV     A,R2
   \   00000E   9412         SUBB    A,#0x12
   \   000010   EB           MOV     A,R3
   \   000011   9400         SUBB    A,#0x0
   \   000013   A2D2         MOV     C,0xD0 /* PSW */.2
   \   000015   65D0         XRL     A,PSW
   \   000017   33           RLC     A
   \   000018   4015         JC      ??SmartHomeApp_ProcessNameAddrMapResp_0
   \   00001A                ; Setup parameters for call to function osal_strlen
   \   00001A   AA..         MOV     R2,?V0 + 0
   \   00001C   AB..         MOV     R3,?V0 + 1
   \   00001E   12....       LCALL   ??osal_strlen?relay
   \   000021   C3           CLR     C
   \   000022   EA           MOV     A,R2
   \   000023   9427         SUBB    A,#0x27
   \   000025   EB           MOV     A,R3
   \   000026   9400         SUBB    A,#0x0
   \   000028   A2D2         MOV     C,0xD0 /* PSW */.2
   \   00002A   65D0         XRL     A,PSW
   \   00002C   33           RLC     A
   \   00002D   4011         JC      ??SmartHomeApp_ProcessNameAddrMapResp_1
    684              // invalid data
    685              printf("Invalid name addr map: %s\n", data);
   \                     ??SmartHomeApp_ProcessNameAddrMapResp_0:
   \   00002F                ; Setup parameters for call to function printf
   \   00002F   78..         MOV     R0,#?V0 + 0
   \   000031   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000034   7A..         MOV     R2,#`?<Constant "Invalid name addr map...">` & 0xff
   \   000036   7B..         MOV     R3,#(`?<Constant "Invalid name addr map...">` >> 8) & 0xff
   \   000038   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   00003B   12....       LCALL   ?DEALLOC_XSTACK8
    686              return;
   \   00003E   802C         SJMP    ??SmartHomeApp_ProcessNameAddrMapResp_2
    687            }
    688            
    689            
    690            uint8* addrPtr = data + 12;
    691            uint8* namePtr = data + 17;
    692            uint16 addr = Util_Str2Uint16(addrPtr);
   \                     ??SmartHomeApp_ProcessNameAddrMapResp_1:
   \   000040                ; Setup parameters for call to function Util_Str2Uint16
   \   000040   E5..         MOV     A,?V0 + 0
   \   000042   240C         ADD     A,#0xc
   \   000044   FA           MOV     R2,A
   \   000045   E5..         MOV     A,?V0 + 1
   \   000047   3400         ADDC    A,#0x0
   \   000049   FB           MOV     R3,A
   \   00004A   12....       LCALL   ??Util_Str2Uint16?relay
   \   00004D   8A..         MOV     ?V0 + 2,R2
   \   00004F   8B..         MOV     ?V0 + 3,R3
   \   000051   AC..         MOV     R4,?V0 + 2
   \   000053   AD..         MOV     R5,?V0 + 3
    693            
    694           // printf("addrPtr: %s, name=%s, add=%04X\n", addrPtr, namePtr, addr);
    695            
    696            if (addr != 0xFFFF) {
   \   000055   74FF         MOV     A,#-0x1
   \   000057   6C           XRL     A,R4
   \   000058   7003         JNZ     ??SmartHomeApp_ProcessNameAddrMapResp_3
   \   00005A   74FF         MOV     A,#-0x1
   \   00005C   6D           XRL     A,R5
   \                     ??SmartHomeApp_ProcessNameAddrMapResp_3:
   \   00005D   600D         JZ      ??SmartHomeApp_ProcessNameAddrMapResp_2
    697              NameAddrCache_put(namePtr, addr); 
   \   00005F                ; Setup parameters for call to function NameAddrCache_put
   \   00005F   E5..         MOV     A,?V0 + 0
   \   000061   2411         ADD     A,#0x11
   \   000063   FA           MOV     R2,A
   \   000064   E5..         MOV     A,?V0 + 1
   \   000066   3400         ADDC    A,#0x0
   \   000068   FB           MOV     R3,A
   \   000069   12....       LCALL   ??NameAddrCache_put?relay
    698            }
   \                     ??SmartHomeApp_ProcessNameAddrMapResp_2:
   \   00006C                REQUIRE ?Subroutine0
   \   00006C                ; // Fall through to label ?Subroutine0
    699          }
    700          
    701          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    702          static void SmartHomeApp_SendNameAddrResp(afIncomingMSGPacket_t *pkt)
   \                     SmartHomeApp_SendNameAddrResp:
    703          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 64
   \   000005   74C0         MOV     A,#-0x40
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    704            uint8 buf[64];
    705            
    706            
    707            SmartHomeApp_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   00000A   90....       MOV     DPTR,#SmartHomeApp_DstAddr + 8
   \   00000D   7402         MOV     A,#0x2
   \   00000F   F0           MOVX    @DPTR,A
    708            SmartHomeApp_DstAddr.endPoint = SmartHomeApp_ENDPOINT;
   \   000010   A3           INC     DPTR
   \   000011   740A         MOV     A,#0xa
   \   000013   12....       LCALL   ?Subroutine5 & 0xFFFF
    709            SmartHomeApp_DstAddr.addr.shortAddr = pkt->srcAddr.addr.shortAddr;
   \                     ??CrossCallReturnLabel_20:
   \   000016   12....       LCALL   ?Subroutine10 & 0xFFFF
    710            
    711            sprintf((char*)buf, "NameAddrMap %04X %s", NLME_GetShortAddr(), (char*)Util_ReadName());
   \                     ??CrossCallReturnLabel_34:
   \   000019                ; Setup parameters for call to function Util_ReadName
   \   000019   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   00001C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001F                ; Setup parameters for call to function NLME_GetShortAddr
   \   00001F   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000022   8A..         MOV     ?V0 + 0,R2
   \   000024   8B..         MOV     ?V0 + 1,R3
   \   000026   78..         MOV     R0,#?V0 + 0
   \   000028   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00002B   7C..         MOV     R4,#`?<Constant "NameAddrMap %04X %s">` & 0xff
   \   00002D   7D..         MOV     R5,#(`?<Constant "NameAddrMap %04X %s">` >> 8) & 0xff
   \   00002F   7404         MOV     A,#0x4
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   AA82         MOV     R2,DPL
   \   000036   AB83         MOV     R3,DPH
   \   000038   12....       LCALL   ??sprintf?relay
   \   00003B   7404         MOV     A,#0x4
   \   00003D   12....       LCALL   ?DEALLOC_XSTACK8
    712              
    713            if ( AF_DataRequest( &SmartHomeApp_DstAddr, &SmartHomeApp_epDesc,
    714                                 SmartHomeApp_CLUSTERID,
    715                                 osal_strlen((char*)buf)+1,
    716                                 (uint8*)buf,
    717                                 &SmartHomeApp_TransID,
    718                                 AF_DISCV_ROUTE, AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   000040                ; Setup parameters for call to function AF_DataRequest
   \   000040   75..1E       MOV     ?V0 + 0,#0x1e
   \   000043   78..         MOV     R0,#?V0 + 0
   \   000045   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000048   75....       MOV     ?V0 + 0,#SmartHomeApp_TransID & 0xff
   \   00004B   75....       MOV     ?V0 + 1,#(SmartHomeApp_TransID >> 8) & 0xff
   \   00004E   78..         MOV     R0,#?V0 + 0
   \   000050   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000053   7403         MOV     A,#0x3
   \   000055   12....       LCALL   ?XSTACK_DISP0_8
   \   000058   8582..       MOV     ?V0 + 0,DPL
   \   00005B   8583..       MOV     ?V0 + 1,DPH
   \   00005E   78..         MOV     R0,#?V0 + 0
   \   000060   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000063                ; Setup parameters for call to function osal_strlen
   \   000063   7405         MOV     A,#0x5
   \   000065   12....       LCALL   ?XSTACK_DISP0_8
   \   000068   12....       LCALL   ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_32:
   \   00006B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006E   75..01       MOV     ?V0 + 0,#0x1
   \   000071   75..00       MOV     ?V0 + 1,#0x0
   \   000074   78..         MOV     R0,#?V0 + 0
   \   000076   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000079   7920         MOV     R1,#0x20
   \   00007B   7C..         MOV     R4,#SmartHomeApp_epDesc & 0xff
   \   00007D   7D..         MOV     R5,#(SmartHomeApp_epDesc >> 8) & 0xff
   \   00007F   7A..         MOV     R2,#SmartHomeApp_DstAddr & 0xff
   \   000081   7B..         MOV     R3,#(SmartHomeApp_DstAddr >> 8) & 0xff
   \   000083   12....       LCALL   ??AF_DataRequest?relay
   \   000086   7409         MOV     A,#0x9
   \   000088   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008B   E9           MOV     A,R1
   \   00008C   601B         JZ      ??SmartHomeApp_SendNameAddrResp_0
    719            {
    720              // Successfully requested to be sent.
    721            }
    722            else
    723            {
    724              printf("SmartHomeApp_SendNameAddrResp error %s\n", buf);
   \   00008E                ; Setup parameters for call to function printf
   \   00008E   85..82       MOV     DPL,?XSP + 0
   \   000091   85..83       MOV     DPH,?XSP + 1
   \   000094   8582..       MOV     ?V0 + 0,DPL
   \   000097   8583..       MOV     ?V0 + 1,DPH
   \   00009A   78..         MOV     R0,#?V0 + 0
   \   00009C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009F   7A..         MOV     R2,#`?<Constant "SmartHomeApp_SendName...">` & 0xff
   \   0000A1   7B..         MOV     R3,#(`?<Constant "SmartHomeApp_SendName...">` >> 8) & 0xff
   \   0000A3   12....       LCALL   ?Subroutine3 & 0xFFFF
    725            }
   \                     ??CrossCallReturnLabel_14:
   \   0000A6   12....       LCALL   ?DEALLOC_XSTACK8
    726            
    727          }
   \                     ??SmartHomeApp_SendNameAddrResp_0:
   \   0000A9   7440         MOV     A,#0x40
   \   0000AB   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000AE   02....       LJMP    ?Subroutine0 & 0xFFFF
    728          
    729          
    730          static uint8 SmartHomeApp_NameAddrNotMatch(uint8* data)
    731          {
    732            // find name and cmpare  
    733            uint8* name;
    734            uint8 ret;
    735            
    736            name = Util_GetNameFromCmd(data);
    737            
    738            if (name == NULL)
    739              return 1;
    740           
    741            
    742            ret = Util_StrEqual(name, Util_ReadName());
    743            osal_mem_free(name);
    744            return !ret;
    745            
    746          }
    747          
    748          /*********************************************************************
    749           * @fn      SmartHomeApp_MessageMSGCB
    750           *
    751           * @brief   Data message processor callback.  This function processes
    752           *          any incoming data - probably from other devices.  So, based
    753           *          on cluster ID, perform the intended action.
    754           *
    755           * @param   none
    756           *
    757           * @return  none
    758           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    759          static void SmartHomeApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
   \                     SmartHomeApp_MessageMSGCB:
    760          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    761            switch ( pkt->clusterId )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   6401         XRL     A,#0x1
   \   000014   7002         JNZ     ??SmartHomeApp_MessageMSGCB_0
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \                     ??SmartHomeApp_MessageMSGCB_0:
   \   000018   6003         JZ      $+5
   \   00001A   02....       LJMP    ??SmartHomeApp_MessageMSGCB_1 & 0xFFFF
    762            {
    763              case SmartHomeApp_CLUSTERID:
    764                pkt->cmd.Data[pkt->cmd.DataLength-1]=0;
   \   00001D   EE           MOV     A,R6
   \   00001E   2422         ADD     A,#0x22
   \   000020   F8           MOV     R0,A
   \   000021   EF           MOV     A,R7
   \   000022   3400         ADDC    A,#0x0
   \   000024   F9           MOV     R1,A
   \   000025   88..         MOV     ?V0 + 0,R0
   \   000027   89..         MOV     ?V0 + 1,R1
   \   000029   EE           MOV     A,R6
   \   00002A   2420         ADD     A,#0x20
   \   00002C   12....       LCALL   ??Subroutine15_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_46:
   \   00002F   F8           MOV     R0,A
   \   000030   A3           INC     DPTR
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F9           MOV     R1,A
   \   000033   85..82       MOV     DPL,?V0 + 0
   \   000036   85..83       MOV     DPH,?V0 + 1
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   28           ADD     A,R0
   \   00003B   F8           MOV     R0,A
   \   00003C   A3           INC     DPTR
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   39           ADDC    A,R1
   \   00003F   F9           MOV     R1,A
   \   000040   E8           MOV     A,R0
   \   000041   24FF         ADD     A,#-0x1
   \   000043   F582         MOV     DPL,A
   \   000045   E9           MOV     A,R1
   \   000046   34FF         ADDC    A,#-0x1
   \   000048   F583         MOV     DPH,A
   \   00004A   E4           CLR     A
   \   00004B   F0           MOVX    @DPTR,A
    765                printf("ReceiveMsg:%s\n", pkt->cmd.Data);
   \   00004C                ; Setup parameters for call to function printf
   \   00004C   85..82       MOV     DPL,?V0 + 0
   \   00004F   85..83       MOV     DPH,?V0 + 1
   \   000052   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000055   7A..         MOV     R2,#`?<Constant "ReceiveMsg:%s\\n">` & 0xff
   \   000057   7B..         MOV     R3,#(`?<Constant "ReceiveMsg:%s\\n">` >> 8) & 0xff
   \   000059   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_15:
   \   00005C   12....       LCALL   ?DEALLOC_XSTACK8
    766                
    767                if (Util_StrEqual(pkt->cmd.Data, (uint8*)"ReportNames")) {
   \   00005F                ; Setup parameters for call to function Util_StrEqual
   \   00005F   7C..         MOV     R4,#`?<Constant "ReportNames">` & 0xff
   \   000061   7D..         MOV     R5,#(`?<Constant "ReportNames">` >> 8) & 0xff
   \   000063   85..82       MOV     DPL,?V0 + 0
   \   000066   85..83       MOV     DPH,?V0 + 1
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   FA           MOV     R2,A
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   FB           MOV     R3,A
   \   00006E   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_43:
   \   000071   6009         JZ      ??SmartHomeApp_MessageMSGCB_2
    768                  SmartHomeApp_ProcessReportNames(pkt); 
   \   000073                ; Setup parameters for call to function SmartHomeApp_ProcessReportNames
   \   000073   EE           MOV     A,R6
   \   000074   FA           MOV     R2,A
   \   000075   EF           MOV     A,R7
   \   000076   FB           MOV     R3,A
   \   000077   12....       LCALL   ??SmartHomeApp_ProcessReportNames?relay
   \   00007A   806D         SJMP    ??SmartHomeApp_MessageMSGCB_1
    769                } else if (Util_StartWith(pkt->cmd.Data, (uint8*)"NameAddrMap ")) {
   \                     ??SmartHomeApp_MessageMSGCB_2:
   \   00007C                ; Setup parameters for call to function Util_StartWith
   \   00007C   7C..         MOV     R4,#`?<Constant "NameAddrMap ">` & 0xff
   \   00007E   7D..         MOV     R5,#(`?<Constant "NameAddrMap ">` >> 8) & 0xff
   \   000080   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_27:
   \   000083   12....       LCALL   ??Util_StartWith?relay
   \   000086   E9           MOV     A,R1
   \   000087   6008         JZ      ??SmartHomeApp_MessageMSGCB_3
    770                  SmartHomeApp_ProcessNameAddrMapResp(pkt->cmd.Data); 
   \   000089                ; Setup parameters for call to function SmartHomeApp_ProcessNameAddrMapResp
   \   000089   12....       LCALL   ?Subroutine8 & 0xFFFF
    771                } else {
   \                     ??CrossCallReturnLabel_28:
   \   00008C   12....       LCALL   ??SmartHomeApp_ProcessNameAddrMapResp?relay
   \   00008F   8058         SJMP    ??SmartHomeApp_MessageMSGCB_1
    772                  
    773                  if (SmartHomeApp_NameAddrNotMatch(pkt->cmd.Data)) { // maybe wrong cache data
   \                     ??SmartHomeApp_MessageMSGCB_3:
   \   000091                ; Setup parameters for call to function Util_GetNameFromCmd
   \   000091   12....       LCALL   ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   000094   12....       LCALL   ??Util_GetNameFromCmd?relay
   \   000097   8A..         MOV     ?V0 + 0,R2
   \   000099   8B..         MOV     ?V0 + 1,R3
   \   00009B   EA           MOV     A,R2
   \   00009C   45..         ORL     A,?V0 + 1
   \   00009E   701E         JNZ     ??SmartHomeApp_MessageMSGCB_4
    774                    printf("NameAddrNotMatch %s\n", pkt->cmd.Data);
   \                     ??SmartHomeApp_MessageMSGCB_5:
   \   0000A0                ; Setup parameters for call to function printf
   \   0000A0   12....       LCALL   ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_37:
   \   0000A3   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000A6   7A..         MOV     R2,#`?<Constant "NameAddrNotMatch %s\\n">` & 0xff
   \   0000A8   7B..         MOV     R3,#(`?<Constant "NameAddrNotMatch %s\\n">` >> 8) & 0xff
   \   0000AA   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   0000AD   12....       LCALL   ?DEALLOC_XSTACK8
    775                    if (!pkt->wasBroadcast) {
   \   0000B0   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_47:
   \   0000B3   7034         JNZ     ??SmartHomeApp_MessageMSGCB_1
    776                      SmartHomeApp_SendNameAddrResp(pkt);
   \   0000B5                ; Setup parameters for call to function SmartHomeApp_SendNameAddrResp
   \   0000B5   EE           MOV     A,R6
   \   0000B6   FA           MOV     R2,A
   \   0000B7   EF           MOV     A,R7
   \   0000B8   FB           MOV     R3,A
   \   0000B9   12....       LCALL   ??SmartHomeApp_SendNameAddrResp?relay
   \   0000BC   802B         SJMP    ??SmartHomeApp_MessageMSGCB_1
   \                     ??SmartHomeApp_MessageMSGCB_4:
   \   0000BE                ; Setup parameters for call to function Util_StrEqual
   \   0000BE                ; Setup parameters for call to function Util_ReadName
    777                    }
    778                    return;
    779                  }
   \   0000BE   12....       LCALL   ?Subroutine4 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   0000C1   12....       LCALL   ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_44:
   \   0000C4   F5..         MOV     ?V0 + 2,A
   \   0000C6                ; Setup parameters for call to function osal_mem_free
   \   0000C6   AA..         MOV     R2,?V0 + 0
   \   0000C8   AB..         MOV     R3,?V0 + 1
   \   0000CA   12....       LCALL   ??osal_mem_free?relay
   \   0000CD   E5..         MOV     A,?V0 + 2
   \   0000CF   60CF         JZ      ??SmartHomeApp_MessageMSGCB_5
    780                  
    781                  if (pkt->wasBroadcast) {
   \   0000D1   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_48:
   \   0000D4   6007         JZ      ??SmartHomeApp_MessageMSGCB_6
    782                    SmartHomeApp_SendNameAddrResp(pkt); 
   \   0000D6                ; Setup parameters for call to function SmartHomeApp_SendNameAddrResp
   \   0000D6   EE           MOV     A,R6
   \   0000D7   FA           MOV     R2,A
   \   0000D8   EF           MOV     A,R7
   \   0000D9   FB           MOV     R3,A
   \   0000DA   12....       LCALL   ??SmartHomeApp_SendNameAddrResp?relay
    783                  }
    784                  
    785                  Processor_HandleMsg(pkt->cmd.Data);
   \                     ??SmartHomeApp_MessageMSGCB_6:
   \   0000DD                ; Setup parameters for indirect call
   \   0000DD   12....       LCALL   ?Subroutine8 & 0xFFFF
    786                }
    787                
    788          //#if defined( LCD_SUPPORTED )
    789          //      HalLcdWriteScreen( (char*)pkt->cmd.Data, "rcvd" );
    790          //#elif defined( WIN32 )
    791          //      WPRINTSTR( pkt->cmd.Data );
    792          //#endif
    793                break;
    794            }
   \                     ??CrossCallReturnLabel_30:
   \   0000E0   90....       MOV     DPTR,#Processor_HandleMsg
   \   0000E3   12....       LCALL   ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_26:
   \   0000E6   12....       LCALL   ?CALL_IND
   \                     ??SmartHomeApp_MessageMSGCB_1:
   \   0000E9   02....       LJMP    ?Subroutine0 & 0xFFFF
    795          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   EE           MOV     A,R6
   \   000001   2415         ADD     A,#0x15
   \   000003                REQUIRE ??Subroutine15_0
   \   000003                ; // Fall through to label ??Subroutine15_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine15_0:
   \   000000   F582         MOV     DPL,A
   \   000002   EF           MOV     A,R7
   \   000003                REQUIRE ??Subroutine16_0
   \   000003                ; // Fall through to label ??Subroutine16_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   12....       LCALL   ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_38:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FA           MOV     R2,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FB           MOV     R3,A
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   EE           MOV     A,R6
   \   000001   2422         ADD     A,#0x22
   \   000003   F582         MOV     DPL,A
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   22           RET

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHome_SendCmd?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHome_SendCmd

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??processUartCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    processUartCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_CallBack?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_CallBack

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_ProcessReportNames?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_ProcessReportNames

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_ProcessNameAddrMapResp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_ProcessNameAddrMapResp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_SendNameAddrResp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_SendNameAddrResp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SmartHomeApp_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SmartHomeApp_MessageMSGCB

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "My name is %s\\n">`:
   \   000000   4D79206E     DB "My name is %s\012"
   \            616D6520
   \            69732025
   \            730A00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "DoorLight">`:
   \   000000   446F6F72     DB "DoorLight"
   \            4C696768
   \            7400    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "DoorSensor">`:
   \   000000   446F6F72     DB "DoorSensor"
   \            53656E73
   \            6F7200  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ERROR: Unkown name: %s\\n">`:
   \   000000   4552524F     DB "ERROR: Unkown name: %s\012"
   \            523A2055
   \            6E6B6F77
   \            6E206E61
   \            6D653A20
   \            25730A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SendCmdFailed:%s\\n">`:
   \   000000   53656E64     DB "SendCmdFailed:%s\012"
   \            436D6446
   \            61696C65
   \            643A2573
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ReadName">`:
   \   000000   52656164     DB "ReadName"
   \            4E616D65
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ReadName:%s\\n">`:
   \   000000   52656164     DB "ReadName:%s\012"
   \            4E616D65
   \            3A25730A
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "WriteName ">`:
   \   000000   57726974     DB "WriteName "
   \            654E616D
   \            652000  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "WriteName:%s\\n">`:
   \   000000   57726974     DB "WriteName:%s\012"
   \            654E616D
   \            653A2573
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SystemReset">`:
   \   000000   53797374     DB "SystemReset"
   \            656D5265
   \            73657400

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SendCmd ">`:
   \   000000   53656E64     DB "SendCmd "
   \            436D6420
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Unkown Cmd:%s\\n">`:
   \   000000   556E6B6F     DB "Unkown Cmd:%s\012"
   \            776E2043
   \            6D643A25
   \            730A00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SendMsgFailed:%X\\n">`:
   \   000000   53656E64     DB "SendMsgFailed:%X\012"
   \            4D736746
   \            61696C65
   \            643A2558
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SendMsgOK:%X\\n">`:
   \   000000   53656E64     DB "SendMsgOK:%X\012"
   \            4D73674F
   \            4B3A2558
   \            0A00    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Addr=%04X, ParentAddr...">`:
   \   000000   41646472     DB "Addr=%04X, ParentAddr=%04X\012"
   \            3D253034
   \            582C2050
   \            6172656E
   \            74416464
   \            723D2530
   \            34580A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ReportNamesResp %s %0...">`:
   \   000000   5265706F     DB "ReportNamesResp %s %04X %04X"
   \            72744E61
   \            6D657352
   \            65737020
   \            25732025
   \            30345820
   \            25303458
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "send ReportNamesResp ...">`:
   \   000000   73656E64     DB "send ReportNamesResp error %s\012"
   \            20526570
   \            6F72744E
   \            616D6573
   \            52657370
   \            20657272
   \            6F722025
   \            730A00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "Invalid name addr map...">`:
   \   000000   496E7661     DB "Invalid name addr map: %s\012"
   \            6C696420
   \            6E616D65
   \            20616464
   \            72206D61
   \            703A2025
   \            730A00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "NameAddrMap %04X %s">`:
   \   000000   4E616D65     DB "NameAddrMap %04X %s"
   \            41646472
   \            4D617020
   \            25303458
   \            20257300

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "SmartHomeApp_SendName...">`:
   \   000000   536D6172     DB "SmartHomeApp_SendNameAddrResp error %s\012"
   \            74486F6D
   \            65417070
   \            5F53656E
   \            644E616D
   \            65416464
   \            72526573
   \            70206572
   \            726F7220
   \            25730A00

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ReceiveMsg:%s\\n">`:
   \   000000   52656365     DB "ReceiveMsg:%s\012"
   \            6976654D
   \            73673A25
   \            730A00  

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "ReportNames">`:
   \   000000   5265706F     DB "ReportNames"
   \            72744E61
   \            6D657300

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "NameAddrMap ">`:
   \   000000   4E616D65     DB "NameAddrMap "
   \            41646472
   \            4D617020
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "NameAddrNotMatch %s\\n">`:
   \   000000   4E616D65     DB "NameAddrNotMatch %s\012"
   \            41646472
   \            4E6F744D
   \            61746368
   \            2025730A
   \            00      
    796          
    797          /*********************************************************************
    798           * @fn      SmartHomeApp_SendTheMessage
    799           *
    800           * @brief   Send "the" message.
    801           *
    802           * @param   none
    803           *
    804           * @return  none
    805           */
    806          //static void SmartHomeApp_SendTheMessage( void )
    807          //{
    808          //  char theMessageData[] = "Hello World";
    809          //
    810          //  if ( AF_DataRequest( &SmartHomeApp_DstAddr, &SmartHomeApp_epDesc,
    811          //                       SmartHomeApp_CLUSTERID,
    812          //                       (byte)osal_strlen( theMessageData ) + 1,
    813          //                       (byte *)&theMessageData,
    814          //                       &SmartHomeApp_TransID,
    815          //                       AF_DISCV_ROUTE, AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
    816          //  {
    817          //    // Successfully requested to be sent.
    818          //  }
    819          //  else
    820          //  {
    821          //    // Error occurred in request to send.
    822          //  }
    823          //}
    824          
    825          
    826          /*********************************************************************
    827           */

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     SmartHomeApp_CallBack              0      0      9
       -> HalUARTRead                   0      0     18
       -> processUartCB                 0      0     18
     SmartHomeApp_Init                  0      0     41
       -> HalUARTOpen                   0      0     78
       -> Util_ReadName                 0      0     78
       -> printf                        0      0     82
       -> Util_ReadName                 0      0     78
       -> Util_StrEqual                 0      0     78
       -> Util_ReadName                 0      0     78
       -> Util_StrEqual                 0      0     78
       -> Util_ReadName                 0      0     78
       -> printf                        0      0     82
       -> afRegister                    0      0     78
       -> RegisterForKeys               0      0     78
       -> ZDO_RegisterForZDOMsg         0      0     78
       -> ZDO_RegisterForZDOMsg         0      0     78
     SmartHomeApp_MessageMSGCB          0      0     28
       -> printf                        0      0     28
       -> Util_StrEqual                 0      0     24
       -> SmartHomeApp_ProcessReportNames
                                        0      0     24
       -> Util_StartWith                0      0     24
       -> SmartHomeApp_ProcessNameAddrMapResp
                                        0      0     24
       -> Util_GetNameFromCmd           0      0     24
       -> printf                        0      0     28
       -> SmartHomeApp_SendNameAddrResp
                                        0      0     24
       -> Util_ReadName                 0      0     24
       -> Util_StrEqual                 0      0     24
       -> osal_mem_free                 0      0     24
       -> SmartHomeApp_SendNameAddrResp
                                        0      0     24
     SmartHomeApp_ProcessEvent          0      0     18
       -> osal_msg_receive              0      0     28
       -> NLME_GetShortAddr             0      0     28
       -> NLME_GetCoordShortAddr        0      0     28
       -> printf                        0      0     36
       -> osal_start_timerEx            0      0     28
       -> osal_msg_deallocate           0      0     28
       -> osal_msg_receive              0      0     28
       -> ZDO_ParseEPListRsp            0      0     28
       -> HalLedSet                     0      0     28
       -> osal_mem_free                 0      0     28
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28
       -> printf                        0      0     32
       -> NameAddrCache_delete          0      0     28
       -> printf                        0      0     32
       -> SmartHomeApp_MessageMSGCB     0      0     28
       -> osal_start_timerEx            0      0     28
     SmartHomeApp_ProcessNameAddrMapResp
                                        0      0     26
       -> osal_strlen                   0      0     24
       -> osal_strlen                   0      0     24
       -> printf                        0      0     28
       -> Util_Str2Uint16               0      0     24
       -> NameAddrCache_put             0      0     24
     SmartHomeApp_ProcessReportNames
                                        0      0     83
       -> NLME_GetShortAddr             0      0    124
       -> NLME_GetCoordShortAddr        0      0    124
       -> Util_ReadName                 0      0    132
       -> sprintf                       0      0    136
       -> osal_strlen                   0      0    134
       -> AF_DataRequest                0      0    142
       -> printf                        0      0    128
     SmartHomeApp_SendNameAddrResp      0      0     97
       -> Util_ReadName                 0      0    152
       -> NLME_GetShortAddr             0      0    156
       -> sprintf                       0      0    160
       -> osal_strlen                   0      0    162
       -> AF_DataRequest                0      0    170
       -> printf                        0      0    156
     SmartHome_SendCmd                  0      0     33
       -> NameAddrCache_getAddrFromCmd
                                        0      0     24
       -> osal_strlen                   0      0     34
       -> AF_DataRequest                0      0     42
       -> printf                        0      0     28
     processUartCB                      0      0     23
       -> Util_StrEqual                 0      0     24
       -> Util_ReadName                 0      0     24
       -> printf                        0      0     28
       -> Util_StartWith                0      0     24
       -> Util_WriteName                0      0     24
       -> Util_ReadName                 0      0     24
       -> printf                        0      0     28
       -> Util_StrEqual                 0      0     24
       -> Util_StartWith                0      0     24
       -> SmartHome_SendCmd             0      0     24
       -> printf                        0      0     28


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     _A_IEN0                                        1
     WDCTL                                          1
     SmartHomeApp_ClusterList                       2
     SmartHomeApp_SimpleDesc                       12
     SmartHomeApp_epDesc                            6
     RxBuf                                         65
     SerialApp_TxLen                                1
     SmartHomeApp_LastSendAddr                      2
     SmartHomeApp_LastSendTransID                   2
     SmartHomeApp_TaskID                            1
     SmartHomeApp_NwkState                          1
     SmartHomeApp_TransID                           1
     SmartHomeApp_DstAddr                          12
     Processor_HandleKeys                           2
     Processor_HandleMsg                            2
     Processor_Init                                 2
     Processor_Update                               2
     SmartHomeApp_Init                            400
     ??Subroutine14_0                               5
     ?Subroutine7                                   9
     ?Subroutine3                                   6
     ?Subroutine2                                  10
     ?Subroutine4                                   8
     SmartHome_SendCmd                            169
     ?Subroutine0                                   5
     processUartCB                                147
     ?Subroutine6                                   4
     SmartHomeApp_CallBack                         74
     SmartHomeApp_ProcessEvent                    449
     ?Subroutine1                                   5
     ?Subroutine12                                 14
     ?Subroutine5                                  10
     ??Subroutine16_0                               6
     SmartHomeApp_ProcessReportNames
                                                  199
     ?Subroutine10                                  6
     ?Subroutine9                                  20
     SmartHomeApp_ProcessNameAddrMapResp
                                                  108
     SmartHomeApp_SendNameAddrResp                177
     SmartHomeApp_MessageMSGCB                    236
     ?Subroutine11                                  3
     ??Subroutine15_0                               3
     ?Subroutine8                                   9
     ?Subroutine13                                 11
     ??SmartHomeApp_Init?relay                      6
     ??SmartHome_SendCmd?relay                      6
     ??processUartCB?relay                          6
     ??SmartHomeApp_CallBack?relay                  6
     ??SmartHomeApp_ProcessEvent?relay              6
     ??SmartHomeApp_ProcessReportNames?relay        6
     ??SmartHomeApp_ProcessNameAddrMapResp?relay    6
     ??SmartHomeApp_SendNameAddrResp?relay          6
     ??SmartHomeApp_MessageMSGCB?relay              6
     ?<Constant "My name is %s\n">                 15
     ?<Constant "DoorLight">                       10
     ?<Constant "DoorSensor">                      11
     ?<Constant "ERROR: Unkown name: %s\n">        24
     ?<Constant "SendCmdFailed:%s\n">              18
     ?<Constant "ReadName">                         9
     ?<Constant "ReadName:%s\n">                   13
     ?<Constant "WriteName ">                      11
     ?<Constant "WriteName:%s\n">                  14
     ?<Constant "SystemReset">                     12
     ?<Constant "SendCmd ">                         9
     ?<Constant "Unkown Cmd:%s\n">                 15
     ?<Constant "SendMsgFailed:%X\n">              18
     ?<Constant "SendMsgOK:%X\n">                  14
     ?<Constant "Addr=%04X, ParentAddr...">        28
     ?<Constant "ReportNamesResp %s %0...">        29
     ?<Constant "send ReportNamesResp ...">        31
     ?<Constant "Invalid name addr map...">        27
     ?<Constant "NameAddrMap %04X %s">             20
     ?<Constant "SmartHomeApp_SendName...">        40
     ?<Constant "ReceiveMsg:%s\n">                 15
     ?<Constant "ReportNames">                     12
     ?<Constant "NameAddrMap ">                    13
     ?<Constant "NameAddrNotMatch %s\n">           21

 
 2 093 bytes in segment BANKED_CODE
    54 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
   443 bytes in segment XDATA_ROM_C
    99 bytes in segment XDATA_Z
 
 2 147 bytes of CODE  memory
   443 bytes of CONST memory
     0 bytes of DATA  memory (+ 2 bytes shared)
    99 bytes of XDATA memory

Errors: none
Warnings: none
